{"version":3,"file":"react-dxcomponents.umd.js","sources":["../src/javascript/themeProvider.js","../src/javascript/dynamicList/SimpleListView.jsx","../src/javascript/dynamicList/DynamicComponentsList.jsx","../src/javascript/picker/PickerViewMaterial.jsx","../src/javascript/picker/PickerViewMaterialMultiple.jsx","../src/javascript/picker/PickerData.jsx","../src/javascript/reduxStore.js","../src/javascript/picker/PickerRedux.jsx","../src/javascript/picker/PickerState.jsx","../src/javascript/picker/Picker.jsx","../src/javascript/picker/PickerView.jsx","../src/javascript/nodesTable/NodesTableViewMaterial.jsx","../src/javascript/nodesTable/NodesTableData.jsx","../src/javascript/nodesTable/NodesTable.jsx","../src/javascript/layout/TestLayout.jsx","../src/javascript/router/createOutletHistory.js","../src/javascript/router/router.js","../src/javascript/engine/Engine.jsx","../src/javascript/router/RouterExample.jsx","../src/javascript/mutations/Mutation.jsx"],"sourcesContent":["import {getMuiTheme, lightBaseTheme} from 'material-ui/styles/index';\nimport * as _ from \"lodash\";\n\nfunction muiTheme() {\n    let ssrMode = (typeof window === 'undefined');\n    if (ssrMode) {\n        var req = global.request;\n\n        let theme = _.clone(lightBaseTheme);\n        theme.userAgent = req.getHeader(\"User-Agent\");\n        return getMuiTheme(theme);\n    } else {\n        return getMuiTheme(lightBaseTheme);\n    }\n}\n\nexport { muiTheme };","import React from 'react';\nimport {MuiThemeProvider} from 'material-ui/styles/index';\nimport {muiTheme} from '../themeProvider';\n\nclass SimpleListView extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            reactElements: []\n        };\n    }\n\n    // todo should move this code dynamicList itself\n    componentDidMount() {\n        if (this.props.components && !this.done) {\n            this.props.components.then((reactElements) => {\n                this.done = true;\n                this.setState({reactElements: reactElements});\n            });\n        }\n    }\n\n    componentDidUpdate() {\n        this.componentDidMount();\n    }\n\n    render() {\n        return this.done ? (<MuiThemeProvider muiTheme={muiTheme()}><div>{this.state.reactElements}</div></MuiThemeProvider>) : (<div/>);\n    }\n}\n\nexport {SimpleListView}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport {SimpleListView} from './SimpleListView'\nimport {ApolloProvider, graphql} from 'react-apollo';\nimport gql from \"graphql-tag\";\nimport * as _ from \"lodash\";\nimport {client, replaceFragmentsInDocument} from \"@jahia/apollo-dx\";\n\nclass DynamicComponentsList extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.componentCache = [];\n    }\n\n    mapResultsToProps({data, ownProps}) {\n        let components = [];\n\n        let jcr = data.jcr;\n        let safeEval = eval;\n        if (jcr && jcr.nodesByQuery) {\n            components = _.map(_.flatMap(jcr.nodesByQuery.nodes, \"children.nodes\"),(n)=> safeEval(\"(\" + n.renderedView.output + \")\"));\n        }\n\n        let imports = [];\n        _.each(components, c => {\n            imports = imports.concat(c.getImports())\n        });\n        let promise;\n        if (imports.length > 0) {\n            promise = Promise.all(_.map(imports, (imp) => SystemJS.import(imp))).then(m => {\n                let reactElements = _.map(components, (c) => {\n                    let s = c.getImports().length;\n                    let r = c.createElement(React, ReactDOM, ...m);\n                    m.splice(s);\n                    return r;\n                });\n                return reactElements;\n            });\n        }\n\n        return {\n            ...ownProps,\n            components: promise,\n        };\n    }\n\n    mapPropsToOptions(props) {\n        return {\n            variables : {\n                query: \"select * from [reactnt:componentsFolder] where [react:id]='\" + props.id + \"'\"\n            }\n        };\n    }\n\n    render() {\n        let renderComponent = this.props.renderComponent;\n\n        let cacheMatch = _.find(this.componentCache, (f) => f.renderComponent === renderComponent);\n        let Component;\n        if (cacheMatch) {\n            Component = cacheMatch.dataComponent;\n        } else {\n            let query = gql`\n                query ComponentsQuery($query:String!) {\n                    jcr {\n                        nodesByQuery(query:$query) {\n                            nodes {\n                                name\n                                path\n                                primaryNodeType {\n                                    name\n                                }\n                                children {\n                                    nodes {\n                                        name\n                                        path\n                                        primaryNodeType {\n                                            name\n                                        }\n                                        renderedView(templateType:\"js\", view:\"react\") {\n                                            output\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }`;\n\n            Component = graphql(query, {\n                props: this.mapResultsToProps,\n                options: this.mapPropsToOptions\n            })(renderComponent || SimpleListView);\n\n            this.componentCache.push({renderComponent: renderComponent, dataComponent: Component});\n        }\n\n        return (<ApolloProvider client={client}><Component {...this.props} /></ApolloProvider>);\n    }\n}\n\nexport {DynamicComponentsList};\n","import React from 'react';\nimport {IconButton, List, ListItem, makeSelectable} from 'material-ui';\nimport {MuiThemeProvider} from 'material-ui/styles/index';\nimport {muiTheme} from '../themeProvider';\nimport {ExpandLess, ExpandMore} from 'material-ui-icons'\n\nlet SelectableList = makeSelectable(List);\n\nlet PickerViewMaterial = function (props) {\n    return (\n        <MuiThemeProvider muiTheme={muiTheme()}>\n            <SelectableList value={props.selectedPath} onChange={\n                (event, path) => {\n                    if (path && (props.pickerEntries.find(entry => entry.path === path).selectable)) {\n                        props.onSelectItem(path, true)\n                    }\n                }\n            }>\n                {props.pickerEntries.map((entry) =>\n                    (<ListItem value={entry.path} key={entry.path} nestedLevel={entry.depth + 1}\n                               primaryText={props['textRenderer'] ? props['textRenderer'].call(this, entry) : entry.name}\n                               rightIconButton={entry.openable ? (<IconButton\n                                   onClick={() => props.onOpenItem(entry.path, !entry.open)}>{entry.open ?\n                                   <ExpandLess/> : <ExpandMore/>}</IconButton>) : null}\n                    />)\n                )}\n            </SelectableList>\n        </MuiThemeProvider>\n    )\n};\n\nexport {PickerViewMaterial};","import React from 'react';\nimport {Checkbox, IconButton, List, ListItem} from 'material-ui';\nimport {MuiThemeProvider} from 'material-ui/styles/index';\nimport {muiTheme} from '../themeProvider';\n\nimport {ExpandLess, ExpandMore} from 'material-ui-icons'\n\nlet PickerViewMaterialMultiple = function (props) {\n    return (\n        <MuiThemeProvider muiTheme={muiTheme()}>\n            <List>\n                {props.pickerEntries.map((entry) =>\n                    (<ListItem primaryTogglesNestedList={true} key={entry.path} nestedLevel={entry.depth+1} primaryText={props['textRenderer'] ? props['textRenderer'].call(this,entry) : entry.name}\n                               leftCheckbox={entry.selectable ? <Checkbox checked={ entry.selected } /> : null}\n                               onClick={()=>{if (entry.selectable) { props.onSelectItem(entry.path, !entry.selected)}}} rightIconButton={entry.openable ? <IconButton onClick={() => props.onOpenItem(entry.path, !entry.open)}>{ entry.open ? <ExpandLess/> : <ExpandMore/> }</IconButton> : null}\n                    />)\n                )}\n            </List>\n        </MuiThemeProvider>\n\n    )\n};\n\nexport { PickerViewMaterialMultiple };","import React from 'react';\nimport {ApolloProvider, graphql} from 'react-apollo';\nimport gql from \"graphql-tag\";\nimport * as _ from \"lodash\";\nimport {client, replaceFragmentsInDocument} from \"@jahia/apollo-dx\";\nimport {PickerViewMaterial} from './PickerViewMaterial'\nimport {PickerViewMaterialMultiple} from \"./PickerViewMaterialMultiple\";\n\nclass PickerData extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.componentCache = [];\n    }\n\n    mapResultsToProps({data, ownProps}) {\n        let selectedPaths = ownProps.multipleSelection ? ownProps.selectedPaths : [ownProps.selectedPath];\n        let openPaths = ownProps.openPaths;\n\n        let pickerEntries = [];\n        let nodesById = {};\n        let jcr = data.jcr;\n\n        let addNode = function (node, depth, index) {\n            let selected = false;\n            if (node.selectable) {\n                selected = _.indexOf(selectedPaths, node.path) !== -1\n            }\n            let pickerNode = {\n                name: node.name,\n                path: node.path,\n                open: node.openable && _.indexOf(openPaths, node.path) !== -1,\n                selected: selected,\n                openable: node.openable,\n                selectable: node.selectable,\n                depth: depth,\n                prefix: _.repeat(\"&nbsp;\", depth * 3),\n                node: node,\n                hidden: false\n            };\n            pickerEntries.splice(index, 0, pickerNode);\n            nodesById[node.uuid] = pickerNode;\n            return pickerNode;\n        };\n\n        if (jcr) {\n            if (jcr.rootNodes) {\n                _.forEach(jcr.rootNodes, rootNode => {\n                    let root = addNode(rootNode, 0, 0);\n                    root.hidden = ownProps.hideRoot;\n                });\n            }\n            if (jcr.openNodes) {\n                _.sortBy(jcr.openNodes, ['path']).forEach((node) => {\n                    let parent = nodesById[node.uuid];\n                    if (parent) {\n                        let parentIndex = _.indexOf(pickerEntries, parent);\n                        _.forEachRight(node.children.nodes, (child) => {\n                            addNode(child, parent.depth + 1, parentIndex + 1)\n                        })\n                    }\n                });\n            }\n        }\n\n        // Nodes loaded, fill selection list\n        let selectedNodes = _.filter(pickerEntries, (node) => {\n            return node.selected\n        }).map((node) => {\n            return node.node\n        });\n\n        selectedPaths = _.map(selectedNodes, \"path\");\n        pickerEntries = _.filter(pickerEntries, pickerNode => {\n            return !pickerNode.hidden;\n        });\n        return {\n            ...ownProps,\n            pickerEntries: pickerEntries,\n        };\n    }\n\n    mapPropsToOptions(props) {\n        let fullyOpenPath = (props, path) => {\n            let rootFound = false;\n            _.tail(_.split(path, \"/\")).reduce((acc, it) => {\n                if (!rootFound) {\n                    _.forEach(props.rootPaths, rootPath => {\n                        rootFound = rootFound || _.startsWith(acc, rootPath);\n                    })\n                }\n                if (rootFound && _.indexOf(props.openPaths, acc) === -1) {\n                    props.openPaths.push(acc);\n                }\n                return acc + \"/\" + it\n            }, \"\");\n        };\n\n        if (props.multipleSelection) {\n            _.each(props.selectedPaths, path => fullyOpenPath(props, path));\n        } else {\n            fullyOpenPath(props, props.selectedPath);\n        }\n\n        let vars = {\n            rootPaths: props.rootPaths,\n            types: _.union(props.openableTypes, props.selectableTypes),\n            selectable: props.selectableTypes,\n            openable: props.openableTypes,\n            openPaths: props.openPaths,\n        };\n        if (props.variables) {\n            _.assign(vars, props.variables);\n        }\n\n        return {\n            variables: vars\n        }\n    }\n\n    render() {\n        let fragments = this.props.fragments;\n        let renderComponent = this.props.renderComponent;\n\n        let cacheMatch = _.find(this.componentCache, (f) => JSON.stringify(f.fragments) === JSON.stringify(fragments) && f.renderComponent === renderComponent);\n        let Component;\n        if (cacheMatch) {\n            Component = cacheMatch.dataComponent;\n        } else {\n            let query = gql`\n                query PickerQuery($rootPaths:[String!]!, $selectable:[String]!, $openable:[String]!, $openPaths:[String!]!, $types:[String]!) {\n                    jcr {\n                        rootNodes:nodesByPath(paths: $rootPaths) {\n                            path\n                            uuid\n                            name\n                            selectable : isNodeType(type: {types:$selectable})\n                            openable : isNodeType(type: {types:$openable})\n                            ... node\n                        },\n                        openNodes:nodesByPath(paths: $openPaths) {\n                            path\n                            uuid\n                            children(typesFilter:{types:$types}) {\n                                nodes {\n                                    path\n                                    uuid\n                                    name\n                                    selectable : isNodeType(type: {types:$selectable})\n                                    openable : isNodeType(type: {types:$openable})\n                                    ... node\n                                }\n                            }\n                        }\n                    }\n                }`;\n\n            replaceFragmentsInDocument(query, fragments);\n\n            Component = graphql(query, {\n                props: this.mapResultsToProps,\n                options: this.mapPropsToOptions\n            })(renderComponent || this.props.multipleSelection ? PickerViewMaterialMultiple : PickerViewMaterial);\n\n            this.componentCache.push({fragments: fragments, renderComponent: renderComponent, dataComponent: Component});\n        }\n\n        return (<ApolloProvider  client={client}><Component {...this.props} /></ApolloProvider>);\n    }\n}\n\nexport { PickerData };\n","import {createStore} from 'redux'\nimport * as _ from \"lodash\";\n\nconst reducers = {};\n\nconst store = function () {\n    let debugTool;\n    if (typeof window !== 'undefined') {\n        debugTool = window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__({\n            name: \"DX Redux\",\n            instanceId: \"dx\"\n        });\n    }\n\n    return createStore((state = {}, action) => _.mapValues(reducers, (value, key) => value(state[key], action)), debugTool);\n}();\n\nconst resetStateReducer = function(state, action) {\n    if (action.type === 'RESET_STATE') {\n        return undefined;\n    }\n    return state;\n};\n\nexport {reducers, store, resetStateReducer};\n","import React from 'react';\nimport {connect, Provider} from 'react-redux'\nimport {PickerData} from './PickerData'\nimport {reducers, store, resetStateReducer} from \"../reduxStore\";\n\nclass PickerRedux extends React.Component {\n    constructor(props) {\n        super(props);\n        this.PickerReduxWithoutStore = connect(this.mapStateToProps, this.mapDispatchToProps)(PickerData);\n    }\n\n    mapStateToProps(state, ownProps) {\n        if (ownProps.multipleSelection) {\n            return {\n                ...ownProps,\n                openPaths: state[\"openPaths_\" + ownProps.id] ? state[\"openPaths_\" + ownProps.id] : ownProps.openPaths,\n                selectedPaths: state[\"selectedPaths_\" + ownProps.id] ? state[\"selectedPaths_\" + ownProps.id] : ownProps.selectedPaths\n            }\n        } else {\n            return {\n                ...ownProps,\n                openPaths: state[\"openPaths_\" + ownProps.id] ? state[\"openPaths_\" + ownProps.id] : ownProps.openPaths,\n                selectedPath: state[\"selectedPath_\" + ownProps.id] ? state[\"selectedPath_\" + ownProps.id] : ownProps.selectedPath\n            }\n        }\n    };\n\n    mapDispatchToProps(dispatch, ownProps) {\n        return {\n            onSelectItem(path, select) {\n                dispatch({\n                    type: select ? 'SELECT_PICKER_ENTRY_' + ownProps.id : 'UNSELECT_PICKER_ENTRY_' + ownProps.id,\n                    path: path\n                })\n            },\n            onOpenItem(path, open) {\n                dispatch({\n                    type: open ? 'OPEN_PICKER_ENTRY_' + ownProps.id : 'CLOSE_PICKER_ENTRY_' + ownProps.id,\n                    path: path\n                })\n            }\n        }\n    };\n\n    openPaths() {\n        return (state = this.props.openPaths || [], action) => {\n            let index = state.indexOf(action.path);\n            if (action.type === 'OPEN_PICKER_ENTRY_' + this.props.id && index === -1) {\n                return [\n                    ...state,\n                    action.path\n                ]\n            } else if (action.type === 'CLOSE_PICKER_ENTRY_' + this.props.id && index !== -1) {\n                return _.filter(state, (path) => path !== action.path);\n            }\n            return state;\n        };\n    }\n\n\n    selectedPath() {\n        return (state = this.props.selectedPath, action) => {\n            if (action.type === 'SELECT_PICKER_ENTRY_' + this.props.id) {\n                return action.path\n            } else if (action.type === 'UNSELECT_PICKER_ENTRY_' + this.props.id) {\n                return null;\n            }\n            return state;\n        };\n    }\n\n    selectedPaths() {\n        return (state = this.props.selectedPaths || [], action) => {\n            let index = state.indexOf(action.path);\n            if (action.type === 'SELECT_PICKER_ENTRY_' + this.props.id && index === -1) {\n                return [\n                    ...state,\n                    action.path\n                ]\n            } else if (action.type === 'UNSELECT_PICKER_ENTRY_' + this.props.id && index !== -1) {\n                return _.filter(state, (path) => path !== action.path);\n            }\n            return state;\n        };\n    }\n\n\n    componentWillMount() {\n        reducers[\"openPaths_\" + this.props.id] = this.openPaths();\n        if (this.props.multipleSelection) {\n            reducers[\"selectedPaths_\" + this.props.id] = this.selectedPaths();\n        } else {\n            reducers[\"selectedPath_\" + this.props.id] = this.selectedPath();\n        }\n    }\n\n    componentWillUnmount() {\n        reducers[\"openPaths_\" + this.props.id] = resetStateReducer;\n        reducers[\"selectedPath_\" + this.props.id] = resetStateReducer;\n        reducers[\"selectedPaths_\" + this.props.id] = resetStateReducer;\n\n        store.dispatch({type:\"RESET_STATE\"});\n\n        delete reducers[\"openPaths_\" + this.props.id];\n        delete reducers[\"selectedPath_\" + this.props.id];\n        delete reducers[\"selectedPaths_\" + this.props.id];\n    }\n\n    render() {\n        let PickerReduxWithoutStore = this.PickerReduxWithoutStore;\n        return (<Provider store={ store }><PickerReduxWithoutStore {...this.props}/></Provider>)\n    }\n}\n\nexport { PickerRedux };\n","import React from 'react';\nimport {PickerData} from './PickerData';\nimport * as _ from \"lodash\";\n\n\nclass PickerState extends React.Component {\n\n    constructor(props) {\n        super(props);\n        if (props.multipleSelection) {\n            this.state = {\n                openPaths: props.openPaths ? props.openPaths : [],\n                selectedPaths: props.selectedPaths ? props.selectedPaths : []\n            }\n        } else {\n            this.state = {\n                openPaths: props.openPaths ? props.openPaths : [],\n                selectedPath: props.selectedPath ? props.selectedPath : null\n            }\n        }\n    }\n\n    onSelectItem(state, path, selected) {\n        if (this.props.multipleSelection) {\n            this.setState({\n                openPaths: state.openPaths,\n                selectedPaths: selected ? [\n                    ...state.selectedPaths,\n                    path\n                ] : _.filter(state.selectedPaths, (thispath) => thispath !== path),\n            });\n        } else {\n            this.setState({\n                openPaths: state.openPaths,\n                selectedPath: selected ? path : null\n            });\n        }\n\n    }\n\n    onOpenItem(state, path, open) {\n        if (this.props.multipleSelection) {\n            this.setState({\n                openPaths: open ? [\n                    ...state.openPaths,\n                    path\n                ] : _.filter(state.openPaths, (thispath) => thispath !== path),\n                selectedPaths: state.selectedPaths\n            });\n        } else {\n            this.setState({\n                openPaths: open ? [\n                    ...state.openPaths,\n                    path\n                ] : _.filter(state.openPaths, (thispath) => thispath !== path),\n                selectedPath: state.selectedPath\n            });\n        }\n    }\n\n\n    render() {\n        if (this.props.multipleSelection) {\n            return React.createElement(PickerData, {\n                ...this.props,\n                openPaths: this.state.openPaths,\n                selectedPaths: this.state.selectedPaths,\n                onOpenItem: this.onOpenItem.bind(this, this.state),\n                onSelectItem: this.onSelectItem.bind(this, this.state)\n            })\n        } else {\n            return React.createElement(PickerData, {\n                ...this.props,\n                openPaths: this.state.openPaths,\n                selectedPath: this.state.selectedPath,\n                onOpenItem: this.onOpenItem.bind(this, this.state),\n                onSelectItem: this.onSelectItem.bind(this, this.state)\n            })\n        }\n    }\n}\n\nexport { PickerState }\n","import React from 'react';\nimport {PickerRedux} from './PickerRedux'\nimport {PickerState} from './PickerState'\n\nlet Picker = function(props) {\n    let Picker = props.pickerType === \"state\" ? PickerState : PickerRedux;\n    return (<Picker {...props} />);\n};\n\nexport { Picker };","import React from 'react';\n\nlet PickerView = function (props) {\n    return (\n        <div>\n            {props.pickerEntries.map((entry) => (\n                <div key={entry.path} style={{marginLeft: (10* entry.depth)+'px'}}>\n                    <input type=\"checkbox\" checked={ entry.open } onChange={(event) => props.onOpenItem(entry.path, event.target.checked)}/>\n                    <input type=\"checkbox\" checked={ entry.selected } onChange={(event) => props.onSelectItem(entry.path, event.target.checked)}/>\n                    <span>{props['textRenderer'] ? props['textRenderer'].call(this,entry) : entry.name}</span>\n                </div>\n            ))}\n        </div>\n    )\n};\n\nexport { PickerView };","import React from 'react';\nimport {\n    Table,\n    TableBody,\n    TableHeader,\n    TableHeaderColumn,\n    TableRow,\n    TableRowColumn\n} from 'material-ui';\nimport {MuiThemeProvider} from 'material-ui/styles/index';\nimport {muiTheme} from '../themeProvider';\n\nlet NodesTableViewMaterial = function (props) {\n\n    let headers = props['headers'] ? props['headers'] : () => (\n        <TableRow>\n            <TableHeaderColumn>Name</TableHeaderColumn>\n        </TableRow>);\n\n    let row = props['row'] ? props['row'] : (node) => (<TableRow key={node.path}>\n            <TableRowColumn>{props['textRenderer'] ? props['textRenderer'].call(this, node) : node.name}</TableRowColumn>\n        </TableRow>);\n\n    return (\n        <MuiThemeProvider muiTheme={muiTheme()}>\n            <Table>\n                <TableHeader >\n                    {headers()}\n                </TableHeader>\n                <TableBody >\n                    {props.nodes ? props.nodes.map(row) : []}\n                </TableBody>\n            </Table>\n        </MuiThemeProvider>\n    )\n};\n\nexport {NodesTableViewMaterial};","import React from 'react';\nimport {NodesTableViewMaterial} from './NodesTableViewMaterial'\nimport {ApolloProvider, graphql} from 'react-apollo';\nimport gql from \"graphql-tag\";\nimport * as _ from \"lodash\";\nimport {client, replaceFragmentsInDocument} from \"@jahia/apollo-dx\";\n\nclass NodesTableData extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.componentCache = [];\n    }\n\n    mapResultsToProps({data, ownProps}) {\n        let nodes = [];\n\n        let jcr = data.jcr;\n\n        if (jcr) {\n            if (jcr.node) {\n                nodes = jcr.node.children.nodes;\n            }\n        }\n\n        return {\n            ...ownProps,\n            nodes: nodes,\n        };\n    }\n\n    mapPropsToOptions(props) {\n        let vars = {\n            path: props.path,\n            types: props.types,\n        };\n        if (props.variables) {\n            _.assign(vars, props.variables);\n        }\n\n        return {\n            variables: vars,\n            skip: !props.path\n        }\n    }\n\n    render() {\n        let fragments = this.props.fragments;\n        let renderComponent = this.props.renderComponent;\n\n        let cacheMatch = _.find(this.componentCache, (f) => JSON.stringify(f.fragments) === JSON.stringify(fragments) && f.renderComponent === renderComponent);\n        let Component;\n        if (cacheMatch) {\n            Component = cacheMatch.dataComponent;\n        } else {\n            let query = gql`\n                query NodesQuery($path:String!, $types:[String]!) {\n                    jcr {\n                        node:nodeByPath(path: $path) {\n                            path\n                            uuid\n                            name\n                            children(typesFilter:{types:$types}) {\n                                nodes {\n                                    path\n                                    uuid\n                                    name\n                                    ... node\n                                }\n                            }\n                        }\n                    }\n                }`;\n\n            replaceFragmentsInDocument(query, fragments);\n\n            Component = graphql(query, {\n                props: this.mapResultsToProps,\n                options: this.mapPropsToOptions\n            })(renderComponent || NodesTableViewMaterial);\n\n            this.componentCache.push({fragments: fragments, renderComponent: renderComponent, dataComponent: Component});\n        }\n\n        return (<ApolloProvider  client={client}><Component {...this.props} /></ApolloProvider>);\n    }\n}\n\nexport { NodesTableData };\n","import React from 'react';\nimport {NodesTableData} from './NodesTableData'\nimport {connect, Provider} from 'react-redux'\nimport {reducers, store} from \"../reduxStore\";\n\nclass NodesTable extends React.Component {\n    constructor(props) {\n        super(props);\n        this.NodesTableWithoutStore = connect(this.mapStateToProps, this.mapDispatchToProps)(NodesTableData);\n    }\n\n    mapStateToProps(state, ownProps) {\n        return {\n            ...ownProps,\n            path: state[\"selectedPath_\"+ ownProps.id] ? state[\"selectedPath_\"+ ownProps.id] : ownProps.defaultPath,\n        }\n    };\n\n    mapDispatchToProps(dispatch, ownProps) {\n        return {\n        }\n    };\n\n    componentWillMount() {\n    }\n\n    componentWillUnmount() {\n    }\n\n    render() {\n        let NodesTableWithoutStore = this.NodesTableWithoutStore;\n        return (<Provider store={ store }><NodesTableWithoutStore {...this.props}/></Provider>)\n    }\n}\n\nexport { NodesTable };\n","import React from 'react';\nimport { Grid, Row, Col } from 'react-flexbox-grid';\n\nlet TestLayout = function(props) {\n    return (<Grid fluid>\n        <Row>\n            <Col xs={6} md={3}>{props.leftCol}</Col>\n            <Col xs={6} md={6}>{props.rightCol}</Col>\n        </Row>\n    </Grid>);\n};\n\nexport { TestLayout };","import * as _ from \"lodash\";\n\nfunction createOutletHistory(baseHistory, outletName) {\n\n    const getPath = (path) => {\n        let parts = [];\n        let base = baseHistory.location.pathname;\n        let newPath = outletName + ':' + path;\n        if (base.indexOf('(') > -1) {\n            base = base.substr(base.indexOf('(')+1);\n            base = base.substr(0,base.indexOf(')'));\n            parts = base.split('//')\n            parts = _.map(parts, (p)=> (p.startsWith(outletName + ':') ? newPath : p));\n        }\n        if (parts.indexOf(newPath) === -1) {\n            parts.push(newPath);\n        }\n        return '/('+ _.join(parts,'//') + ')';\n    };\n\n    const getState = function (state) {\n        let newState;\n        if (state) {\n            newState = baseHistory.location.state ? baseHistory.location.state : {};\n            newState['router_' + outletName] = state;\n        } else if (baseHistory.location.state) {\n            newState = baseHistory.location.state;\n            delete newState['router_' + outletName]\n        }\n        return newState;\n    };\n\n    const extractPath = function(base) {\n        if (base.indexOf('(') > -1) {\n            base = base.substr(base.indexOf('(') + 1);\n            base = base.substr(0, base.indexOf(')'));\n            let parts = base.split('//')\n            let s = outletName + ':';\n            let part = _.find(parts, (p)=> (p.startsWith(s)));\n            if (part) {\n                return part.substr(s.length)\n            }\n        }\n        return '';\n    };\n\n    let initialLocation = _.clone(baseHistory.location);\n    initialLocation.pathname = extractPath(initialLocation.pathname);\n\n    let listeners = [];\n\n    const history = {\n        length: baseHistory.length,\n        action: baseHistory.action,\n        location: initialLocation,\n        createHref: (location) => {\n            return baseHistory.createHref({pathname:getPath(location.pathname)});\n        },\n        push: (path, state) => {\n            return baseHistory.push(getPath(path),getState(state));\n        },\n        replace: (path, state) => {\n            baseHistory.replace(getPath(path),getState(state));\n        },\n        go: (n) => {\n            baseHistory.go(n)\n        },\n        goBack: () => {\n            baseHistory.goBack()\n        },\n        goForward: () => {\n            baseHistory.goForward()\n        },\n        block:(prompt) => {\n            return baseHistory.block(prompt)\n        },\n        listen: (listener) => {\n            listeners.push(listener);\n            return () => {\n                _.pull(listeners, listener);\n            }\n        },\n        dispose: () => {\n            unlisten();\n        }\n    };\n\n    const unlisten = baseHistory.listen( (event) => {\n        let path = extractPath(event.pathname);\n        let state;\n        if (event.state && event.state['router_' + outletName]) {\n            state = event.state['router_' + outletName];\n        }\n        if (history.location.pathname !== path || history.location.state !== state) {\n            Object.assign(history.location, event);\n            history.location.pathname = path;\n            history.location.state = state;\n            _.each(listeners, (listener) => listener.call(this,history.location))\n        }\n    });\n\n    // unlisten when not used anymore !\n\n    return history\n}\n\nexport { createOutletHistory }","import React from 'react';\n\nimport {createHashHistory} from \"history\";\nimport {createOutletHistory} from \"./createOutletHistory\"\nimport {Router} from 'react-router'\n\nlet baseHistory = createHashHistory();\n\nclass OutletRouter extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.outletHistory = createOutletHistory(baseHistory, props.outlet);\n    }\n\n    componentWillMount() {\n\n    }\n\n    componentWillUnmount() {\n        this.outletHistory.dispose();\n    }\n\n    render() {\n        return (<Router history={this.outletHistory}>{this.props.children}</Router>)\n    }\n}\n\nexport { OutletRouter };","import React from 'react';\nimport {Dialog, FlatButton} from 'material-ui';\nimport {MuiThemeProvider} from 'material-ui/styles/index';\nimport {muiTheme} from '../themeProvider';\nimport * as _ from \"lodash\";\nimport {OutletRouter as Router} from '../router/router'\nimport {Link, Route} from 'react-router-dom'\n\nclass Engine extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            open: false,\n        };\n        this.components = [\n            {\n                link:\"/link1\",\n                label:\"Link 1\",\n                component: (props) => <div>toto</div>\n            },\n            {\n                link:\"/link2\",\n                label:\"Link 2\",\n                component: (props) => (<div>titi</div>)\n            }\n        ];\n    }\n\n    handleOpen() {\n        this.setState({open: true});\n    };\n\n    handleClose() {\n        this.setState({open: false});\n    };\n\n    render() {\n        return (<MuiThemeProvider muiTheme={muiTheme()}>\n            <div>\n                <FlatButton label=\"Open\" onClick={()=>this.handleOpen()}/>\n                <Dialog\n                    title=\"Dialog With Actions\"\n                    actions={[\n                        <FlatButton label=\"Cancel\" primary={true} onClick={()=>this.handleClose()}/>,\n                        <FlatButton label=\"Submit\" primary={true} keyboardFocused={true} onClick={()=>this.handleClose()}/>\n                    ]}\n                    modal={false}\n                    open={this.state.open}\n                    onRequestClose={()=>this.handleClose()}\n                >\n                    <Router outlet={\"outlet1\"}>\n                        <div>\n                            <div>\n                                {_.map(this.components, (e) => (<Link key={e.link} to={e.link}>{e.label}</Link>))}\n                            </div>\n                            <div>\n                                {_.map(this.components, (e) => (<Route key={e.link} path={e.link} component={e.component}/>))}\n                            </div>\n                        </div>\n                    </Router>\n                    <Router outlet={\"outlet2\"}>\n                        <div>\n                            <div>\n                                {_.map(this.components, (e) => (<Link key={e.link} to={e.link}>{e.label}</Link>))}\n                            </div>\n                            <div>\n                                {_.map(this.components, (e) => (<Route key={e.link} path={e.link} component={e.component}/>))}\n                            </div>\n                        </div>\n                    </Router>\n                </Dialog>\n\n            </div>\n        </MuiThemeProvider>);\n    }\n\n\n}\n\nexport {Engine}\n","import React from 'react';\nimport {OutletRouter as Router} from './router'\nimport {Link, Route} from 'react-router-dom'\n\nclass RouterExample extends React.Component {\n\n    constructor(props) {\n        super(props);\n    }\n\n    render() {\n\n        let Test1 = props => (<div>Test1 {props.match.params.value}</div>)\n        let Test2 = props => (<div>Test2</div>);\n        let Test3 = props => (<div>Test3</div>);\n\n        return (<Router outlet={this.props.id}>\n            <div>\n\n                ---- links : ----\n                <Link to={'/test1/toto'}>Test1 toto</Link> -\n                <Link to={'/test1/tutu'}>Test1 tutu</Link> -\n                <Link to={'/test2'}>Test2</Link> -\n                <Link to={'/test3'}>Test3</Link> -\n\n                <Router outlet=\"new\">\n                    <div>\n                        <Link to={'/test1'}>Test1/other</Link> -\n                        <Link to={'/test2'}>Test2/other</Link>\n                    </div>\n                </Router>\n                ---- routes : ----\n                <Route path={'/test1/:value'} component={Test1}/>\n                <Route path={'/test2'} component={Test2}/>\n                <Route path={'/test3'} component={Test3}/>\n\n                <Router outlet=\"new\">\n                    <div>\n                        <Route path={'/test1'} component={Test1}/>\n                        <Route path={'/test2'} component={Test2}/>\n                    </div>\n                </Router>\n\n                ------------------\n            </div>\n        </Router>);\n    }\n\n}\n\nexport {RouterExample}\n","import React, {Component} from 'react';\nimport {ApolloProvider, graphql} from 'react-apollo';\nimport gql from 'graphql-tag';\nimport {client} from \"@jahia/apollo-dx\";\nimport {NodesTableData} from \"../nodesTable/NodesTableData\";\nimport {FlatButton, Table, TableBody, TableHeader, TableHeaderColumn, TableRow, TableRowColumn} from 'material-ui';\nimport {MuiThemeProvider} from 'material-ui/styles/index';\nimport {muiTheme} from '../themeProvider';\n\n\nclass MutationExampleView extends Component {\n\n    constructor(props) {\n        super(props);\n    }\n\n\n    render() {\n        let fragment = gql`fragment Test on JCRNode {\n            myprop:property(name:\"myprop\") {\n                value\n            }\n        }`;\n\n        // let query = gql`query GetNode($path:String!) {\n        //     jcr {\n        //         nodeByPath(path:$path) {\n        //             uuid\n        //             path\n        //             ...Test\n        //         }\n        //     }\n        // } ${fragment}`;\n        //\n        // let update = (proxy, mutationResult) => {\n        //     let updatedPath = mutationResult.data.jcr.mutateNode.node.path;\n        //\n        //     let variables = {path:updatedPath};\n        //     const data = proxy.readQuery({query, variables});\n        //\n        //     delete data.jcr.nodeByPath.myprop;\n        //\n        //     debugger;\n        //\n        //     proxy.writeQuery({query, variables, data});\n        // }\n\n\n        let frags = [{\n            applyFor: \"node\",\n            gql: fragment\n        }];\n\n        let RenderComponent = (props) => (<Table>\n                <TableHeader displaySelectAll={false} >\n                    <TableRow>\n                        <TableHeaderColumn>Name</TableHeaderColumn>\n                        <TableHeaderColumn>Value</TableHeaderColumn>\n                        <TableHeaderColumn>Update</TableHeaderColumn>\n                        <TableHeaderColumn>Delete</TableHeaderColumn>\n                    </TableRow>\n                </TableHeader>\n                <TableBody displayRowCheckbox={false} selectable={false}>\n                    {props.nodes ? props.nodes.map(node =>\n                        <TableRow key={node.uuid}>\n                            <TableRowColumn>{node.name}</TableRowColumn>\n                            <TableRowColumn>{node.myprop.value}</TableRowColumn>\n                            <TableRowColumn><FlatButton label={\"Update\"} onClick={() => this.props.setPropertyMutation({\n                                variables:{\n                                    path:node.path,\n                                    value:(\"test:\"+new Date())\n                                },\n                                refetchQueries: [\"NodesQuery\"]\n                                // update: update\n                            })}/></TableRowColumn>\n                            <TableRowColumn><FlatButton label={\"Delete\"} onClick={() => this.props.removeNodeMutation({\n                                variables:{\n                                    path:node.path,\n                                },\n                                refetchQueries: [\"NodesQuery\"]\n                            })}/></TableRowColumn>\n                        </TableRow>\n                    ) : []}\n                </TableBody>\n            </Table>\n        )\n\n        return (\n            <MuiThemeProvider muiTheme={muiTheme()}>\n            <div>\n            <FlatButton label=\"New\" onClick={() => this.props.addNodeMutation({\n                variables:{\n                    name:(\"name-\"+(new Date().getTime())),\n                    value:(\"test:\"+new Date())\n                },\n                refetchQueries: [\"NodesQuery\"]\n            })} />\n\n            <NodesTableData path={\"/\"} types={[\"nt:unstructured\"]} fragments={frags} renderComponent={RenderComponent}/>\n            </div></MuiThemeProvider>\n        )\n    }\n}\n\nconst setProperty = gql`\n    mutation setProperty($value:String,$path:String!) {\n        jcr {\n            mutateNode(pathOrId:$path) {\n                mutateProperty(name:\"myprop\") {\n                    setValue(value:$value)\n                }\n                node {\n                    path\n                }\n            }\n        }\n    }\n`;\n\nconst addNode = gql`\n    mutation addNode($value:String, $name:String!) {\n        jcr {\n            addNode(parentPathOrId:\"/\",name:$name,primaryNodeType:\"nt:unstructured\") {\n                mutation {\n                    mutateProperty(name:\"myprop\") {\n                        setValue(value:$value)\n                    }\n                }\n            }\n        }\n    }\n`;\n\nconst removeNode = gql`\n    mutation removeNode($path:String!) {\n        jcr {\n            deleteNode(pathOrId:$path) \n        }\n    }\n`;\n\nclass MutationExample extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.Component =\n            graphql(setProperty, { name: 'setPropertyMutation' })(\n                graphql(addNode, { name: 'addNodeMutation' })(\n                    graphql(removeNode, { name: 'removeNodeMutation' })(MutationExampleView)));\n    }\n\n    render() {\n        let Component = this.Component;\n        return (<ApolloProvider client={client}><Component/></ApolloProvider>)\n    }\n}\n\nexport { MutationExample};"],"names":["muiTheme","ssrMode","window","req","global","request","theme","_","lightBaseTheme","userAgent","getHeader","getMuiTheme","SimpleListView","props","state","components","done","then","reactElements","setState","componentDidMount","React","Component","DynamicComponentsList","componentCache","data","ownProps","jcr","safeEval","eval","nodesByQuery","nodes","n","renderedView","output","imports","concat","c","getImports","promise","length","Promise","all","imp","SystemJS","import","s","r","createElement","ReactDOM","m","splice","id","renderComponent","cacheMatch","f","dataComponent","query","gql","graphql","mapResultsToProps","mapPropsToOptions","push","client","SelectableList","makeSelectable","List","PickerViewMaterial","selectedPath","event","path","pickerEntries","find","entry","selectable","onSelectItem","map","ListItem","depth","call","name","openable","onOpenItem","open","ExpandLess","ExpandMore","PickerViewMaterialMultiple","Checkbox","selected","PickerData","selectedPaths","multipleSelection","openPaths","nodesById","addNode","node","index","pickerNode","uuid","rootNodes","root","rootNode","hidden","hideRoot","openNodes","forEach","parent","parentIndex","children","child","selectedNodes","fullyOpenPath","rootFound","reduce","acc","it","rootPaths","rootPath","vars","openableTypes","selectableTypes","variables","fragments","JSON","stringify","reducers","store","debugTool","__REDUX_DEVTOOLS_EXTENSION__","createStore","action","value","key","resetStateReducer","type","undefined","PickerRedux","PickerReduxWithoutStore","connect","mapStateToProps","mapDispatchToProps","dispatch","select","indexOf","filter","PickerState","thispath","bind","Picker","pickerType","PickerView","marginLeft","target","checked","NodesTableViewMaterial","headers","row","NodesTableData","types","NodesTable","NodesTableWithoutStore","defaultPath","TestLayout","leftCol","rightCol","createOutletHistory","baseHistory","outletName","getPath","parts","base","location","pathname","newPath","substr","split","p","startsWith","getState","newState","extractPath","part","initialLocation","listeners","history","createHref","replace","go","goBack","goForward","prompt","block","listener","unlisten","listen","assign","createHashHistory","OutletRouter","outletHistory","outlet","dispose","Engine","FlatButton","handleOpen","handleClose","e","link","label","Route","component","RouterExample","Test1","match","params","Test2","Test3","MutationExampleView","fragment","frags","RenderComponent","myprop","setPropertyMutation","Date","removeNodeMutation","addNodeMutation","getTime","setProperty","removeNode","MutationExample"],"mappings":"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"}