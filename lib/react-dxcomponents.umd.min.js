!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("material-ui"),require("i18next"),require("i18next-xhr-backend"),require("react-i18next"),require("redux"),require("lodash"),require("material-ui/colors"),require("@jahia/apollo-dx"),require("react-apollo"),require("react-redux"),require("react-router-dom"),require("history"),require("react-router"),require("prop-types"),require("react-dom"),require("graphql-tag"),require("material-ui-icons")):"function"==typeof define&&define.amd?define(["exports","react","material-ui","i18next","i18next-xhr-backend","react-i18next","redux","lodash","material-ui/colors","@jahia/apollo-dx","react-apollo","react-redux","react-router-dom","history","react-router","prop-types","react-dom","graphql-tag","material-ui-icons"],t):t((e.jahia=e.jahia||{},e.jahia.reactcomponents={}),e.React,e.materialUi,e.i18n,e.XHR,e.reactI18next,e.redux,e._,e.colors,e.jahia.apollodx,e.reactApollo,e.reactRedux,e.reactRouterDom,e.history,e.reactRouter,e.PropTypes,e.ReactDOM,e.gql,e.materialUiIcons)}(this,function(e,t,n,r,a,o,i,l,u,s,c,p,d,h,m,f,y,g,v){"use strict";var b="default"in t?t.default:t;r=r&&r.hasOwnProperty("default")?r.default:r,a=a&&a.hasOwnProperty("default")?a.default:a,f=f&&f.hasOwnProperty("default")?f.default:f,y=y&&y.hasOwnProperty("default")?y.default:y,g=g&&g.hasOwnProperty("default")?g.default:g;function P(e){return e=e||{},r.use(a).init({lng:e.currentLanguage?e.currentLanguage:void 0,fallbackLng:"en",debug:!0,interpolation:{escapeValue:!1},react:{wait:!1,bindI18n:"languageChanged loaded",bindStore:"added removed",nsMode:"default"},backend:{loadPath:(e.contextPath?e.contextPath:"")+"/modules/{{ns}}/javascript/locales/{{lng}}.json"}}),r}var E={},O=function(){var e=void 0;return"undefined"!=typeof window&&(e=window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__({name:"DX Redux",instanceId:"dx"})),i.createStore(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];return l.mapValues(E,function(n,r){return n(e[r],t)})},e)}(),x=n.createMuiTheme({palette:{contrastThreshold:3.1,tonalOffset:.07,primary:{light:u.indigo[300],main:u.indigo[500],dark:u.indigo[700],contrastText:defaultTheme.palette.getContrastText(u.indigo[500])},secondary:{light:u.pink.A200,main:u.pink.A400,dark:u.pink.A700,contrastText:defaultTheme.palette.getContrastText(u.pink.A400)},error:red.A400}});function T(e,t){var n=this,r=function(n){var r=[],a=e.location.pathname,o=t+":"+n;return a.indexOf("(")>-1&&(r=(a=(a=a.substr(a.indexOf("(")+1)).substr(0,a.indexOf(")"))).split("//"),r=l.map(r,function(e){return e.startsWith(t+":")?o:e})),-1===r.indexOf(o)&&r.push(o),"/("+l.join(r,"//")+")"},a=function(n){var r=void 0;return n?(r=e.location.state?e.location.state:{})["router_"+t]=n:e.location.state&&delete(r=e.location.state)["router_"+t],r},o=function(e){if(e.indexOf("(")>-1){var n=(e=(e=e.substr(e.indexOf("(")+1)).substr(0,e.indexOf(")"))).split("//"),r=t+":",a=l.find(n,function(e){return e.startsWith(r)});if(a)return a.substr(r.length)}return""},i=l.clone(e.location);i.pathname=o(i.pathname);var u=[],s={length:e.length,action:e.action,location:i,createHref:function(t){return e.createHref({pathname:r(t.pathname)})},push:function(t,n){return e.push(r(t),a(n))},replace:function(t,n){e.replace(r(t),a(n))},go:function(t){e.go(t)},goBack:function(){e.goBack()},goForward:function(){e.goForward()},block:function(t){return e.block(t)},listen:function(e){return u.push(e),function(){l.pull(u,e)}},dispose:function(){c()}},c=e.listen(function(e){var r=o(e.pathname),a=void 0;e.state&&e.state["router_"+t]&&(a=e.state["router_"+t]),s.location.pathname===r&&s.location.state===a||(Object.assign(s.location,e),s.location.pathname=r,s.location.state=a,l.each(u,function(e){return e.call(n,s.location)}))});return s}var C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},S=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},j=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n},$=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},q=function(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))},I=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},N=h.createHashHistory(),R=function(e){_(t,e);function t(e){k(this,t);var n=$(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.outletHistory=T(N,e.outlet),n}return S(t,[{key:"componentWillMount",value:function(){}},{key:"componentWillUnmount",value:function(){this.outletHistory.dispose()}},{key:"render",value:function(){return b.createElement(m.Router,{history:this.outletHistory},this.props.children)}}]),t}(b.Component),L=function(e){_(t,e);function t(e){return k(this,t),$(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return S(t,[{key:"render",value:function(){return b.createElement(R,{outlet:this.props.id},b.createElement("div",null,b.createElement(d.Link,{to:"/test1/value1"},"test1/value1"),b.createElement(d.Link,{to:"/test1/value2"},"Test1/value2"),b.createElement(d.Link,{to:"/test2"},"test2"),b.createElement(d.Link,{to:"/test3"},"test3"),b.createElement(d.Route,{path:"/test1/:value",component:function(e){return b.createElement(n.Paper,{elevation:4},b.createElement(n.Typography,{type:"headline",component:"h3"},"Page 1"),b.createElement(n.Typography,{component:"p"},"Param = ",e.match.params.value))}}),b.createElement(d.Route,{path:"/test2",component:function(e){return b.createElement(n.Paper,{elevation:4},b.createElement(n.Typography,{type:"headline",component:"h3"},"Page 2"))}}),b.createElement(d.Route,{path:"/test3",component:function(e){return b.createElement(n.Paper,{elevation:4},b.createElement(n.Typography,{type:"headline",component:"h3"},"Page 3"))}})))}}]),t}(b.Component),M=function(e){_(t,e);function t(e){return k(this,t),$(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return S(t,[{key:"getChildContext",value:function(){return{dxContext:this.props.dxContext}}},{key:"render",value:function(){var e=this.props,t=e.dxContext,r=e.children,a=e.i18n,i=e.apollo,l=e.redux,u=e.mui,h=e.router,m=b.Children.only(r);if(a){var f={currentLanguage:t.uilang,contextPath:t.contextPath};"object"===(void 0===a?"undefined":C(a))&&Object.assign(f,a),m=b.createElement(o.I18nextProvider,{i18n:P(f)},m)}if(h){var y=d.HashRouter,g={};"object"===(void 0===y?"undefined":C(y))&&"outlet"===y.type&&(y=R,g.outlet=y.outlet),m=b.createElement(d.HashRouter,g,m)}if(i){var v={contextPath:t.contextPath};"object"===(void 0===i?"undefined":C(i))&&Object.assign(v,i),m=b.createElement(c.ApolloProvider,{client:s.client(v)},m)}return l&&(m=b.createElement(p.Provider,{store:O},m)),u&&(m=b.createElement(n.MuiThemeProvider,{theme:x},m)),m}}]),t}(b.Component);M.childContextTypes={dxContext:f.object};var B=function(e){_(t,e);function t(e){k(this,t);var n=$(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={reactElements:[]},n}return S(t,[{key:"componentDidMount",value:function(){var e=this;this.props.components&&!this.done&&this.props.components.then(function(t){e.done=!0,e.setState({reactElements:t})})}},{key:"componentDidUpdate",value:function(){this.componentDidMount()}},{key:"render",value:function(){return this.done?b.createElement("div",null,this.state.reactElements):b.createElement("div",null)}}]),t}(b.Component),V=q(['\n                query ComponentsQuery($query:String!) {\n                    jcr {\n                        nodesByQuery(query:$query) {\n                            nodes {\n                                name\n                                path\n                                primaryNodeType {\n                                    name\n                                }\n                                children {\n                                    nodes {\n                                        name\n                                        path\n                                        primaryNodeType {\n                                            name\n                                        }\n                                        renderedView(templateType:"js", view:"react") {\n                                            output\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }'],['\n                query ComponentsQuery($query:String!) {\n                    jcr {\n                        nodesByQuery(query:$query) {\n                            nodes {\n                                name\n                                path\n                                primaryNodeType {\n                                    name\n                                }\n                                children {\n                                    nodes {\n                                        name\n                                        path\n                                        primaryNodeType {\n                                            name\n                                        }\n                                        renderedView(templateType:"js", view:"react") {\n                                            output\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }']),D=function(e){_(t,e);function t(e){k(this,t);var n=$(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.componentCache=[],n}return S(t,[{key:"mapResultsToProps",value:function(e){var t=e.data,n=e.ownProps,r=[],a=t.jcr,o=eval;a&&a.nodesByQuery&&(r=l.map(l.flatMap(a.nodesByQuery.nodes,"children.nodes"),function(e){return o("("+e.renderedView.output+")")}));var i=[];l.each(r,function(e){i=i.concat(e.getImports())});var u=void 0;return i.length>0&&(u=Promise.all(l.map(i,function(e){return SystemJS.import(e)})).then(function(e){return l.map(r,function(t){var n=t.getImports().length,r=t.createElement.apply(t,[b,y].concat(I(e)));return e.splice(n),r})})),w({},n,{components:u})}},{key:"mapPropsToOptions",value:function(e){return{variables:{query:"select * from [reactnt:componentsFolder] where [react:id]='"+e.id+"'"}}}},{key:"render",value:function(){var e=this.props.renderComponent,t=l.find(this.componentCache,function(t){return t.renderComponent===e}),n=void 0;if(t)n=t.dataComponent;else{var r=g(V);n=c.graphql(r,{props:this.mapResultsToProps,options:this.mapPropsToOptions})(e||B),this.componentCache.push({renderComponent:e,dataComponent:n})}return b.createElement(n,this.props)}}]),t}(b.Component);D.propTypes={id:f.string.isRequired,renderComponent:f.element},e.LanguageSwitcher=function(e){_(t,e);function t(e,n){k(this,t);var r=$(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.state={anchorEl:null},r}return S(t,[{key:"handleClick",value:function(e){this.setState({anchorEl:e.target})}},{key:"handleClose",value:function(e){this.setState({anchorEl:null}),e&&this.context.i18n.changeLanguage(e)}},{key:"render",value:function(){var e=this;return b.createElement("div",null,b.createElement(n.Button,{onClick:this.handleClick.bind(this)},this.props.t("label.languages")),b.createElement(n.Menu,{open:Boolean(this.state.anchorEl),onClose:this.handleClose.bind(this,null),anchorEl:this.state.anchorEl},["fr","en"].map(function(t){return b.createElement(n.MenuItem,{onClick:e.handleClose.bind(e,t),key:t,value:t},t)})))}}]),t}(b.Component),e.LanguageSwitcher.contextTypes={i18n:f.object},e.LanguageSwitcher=o.translate("react-dxcomponents")(e.LanguageSwitcher);var Q=function(e){return b.createElement(n.Grid,{container:!0},b.createElement(n.Grid,{item:!0,xs:12,md:6},b.createElement(n.Paper,null," ",e.leftCol)),b.createElement(n.Grid,{item:!0,xs:12,md:6},b.createElement(n.Paper,null,e.rightCol)))};Q.propTypes={leftCol:f.element,rightCol:f.element};var F=q(["\n            query NodesQuery($path:String!, $types:[String]!) {\n                jcr {\n                    node:nodeByPath(path: $path) {\n                        path\n                        uuid\n                        name\n                        children(typesFilter:{types:$types}) {\n                            nodes {\n                                path\n                                uuid\n                                name\n                                ... node\n                            }\n                        }\n                    }\n                }\n            }"],["\n            query NodesQuery($path:String!, $types:[String]!) {\n                jcr {\n                    node:nodeByPath(path: $path) {\n                        path\n                        uuid\n                        name\n                        children(typesFilter:{types:$types}) {\n                            nodes {\n                                path\n                                uuid\n                                name\n                                ... node\n                            }\n                        }\n                    }\n                }\n            }"]);function A(e){return function(t){var n=g(F);return s.replaceFragmentsInDocument(n,e),c.graphql(n,{props:function(e){var t=e.data,n=e.ownProps,r=[],a=t.jcr;return a&&a.node&&(r=a.node.children.nodes),w({},n,{nodes:r})},options:function(e){var t={path:e.path,types:e.types};return e.queryVariables&&l.assign(t,e.queryVariables),{variables:t,skip:!e.path}}})(t)}}var H=q(['fragment Test on JCRNode {\n                myprop:property(name:"myprop") {\n                    value\n                }\n            }'],['fragment Test on JCRNode {\n                myprop:property(name:"myprop") {\n                    value\n                }\n            }']),U=q(['\n    mutation setProperty($value:String,$path:String!) {\n        jcr {\n            mutateNode(pathOrId:$path) {\n                mutateProperty(name:"myprop") {\n                    setValue(value:$value)\n                }\n                node {\n                    path\n                }\n            }\n        }\n    }\n'],['\n    mutation setProperty($value:String,$path:String!) {\n        jcr {\n            mutateNode(pathOrId:$path) {\n                mutateProperty(name:"myprop") {\n                    setValue(value:$value)\n                }\n                node {\n                    path\n                }\n            }\n        }\n    }\n']),W=q(['\n    mutation addNode($value:String, $name:String!) {\n        jcr {\n            addNode(parentPathOrId:"/",name:$name,primaryNodeType:"nt:unstructured") {\n                mutateProperty(name:"myprop") {\n                    setValue(value:$value)\n                }\n            }\n        }\n    }\n'],['\n    mutation addNode($value:String, $name:String!) {\n        jcr {\n            addNode(parentPathOrId:"/",name:$name,primaryNodeType:"nt:unstructured") {\n                mutateProperty(name:"myprop") {\n                    setValue(value:$value)\n                }\n            }\n        }\n    }\n']),X=q(["\n    mutation removeNode($path:String!) {\n        jcr {\n            deleteNode(pathOrId:$path)\n        }\n    }\n"],["\n    mutation removeNode($path:String!) {\n        jcr {\n            deleteNode(pathOrId:$path)\n        }\n    }\n"]),G=function(e){_(t,e);function t(e){k(this,t);var r=$(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.Component=A([{applyFor:"node",gql:g(H)}])(function(e){return b.createElement(n.Table,null,b.createElement(n.TableHead,null,b.createElement(n.TableRow,null,b.createElement(n.TableCell,null,"Name"),b.createElement(n.TableCell,null,"Value"),b.createElement(n.TableCell,null,"Update"),b.createElement(n.TableCell,null,"Delete"))),b.createElement(n.TableBody,null,e.nodes?e.nodes.map(function(e){return b.createElement(n.TableRow,{key:e.uuid},b.createElement(n.TableCell,null,e.name),b.createElement(n.TableCell,null,e.myprop.value),b.createElement(n.TableCell,null,b.createElement(n.Button,{onClick:function(){return r.props.setPropertyMutation({variables:{path:e.path,value:"test:"+new Date},refetchQueries:["NodesQuery"]})}},"Update")),b.createElement(n.TableCell,null,b.createElement(n.Button,{onClick:function(){return r.props.removeNodeMutation({variables:{path:e.path},refetchQueries:["NodesQuery"]})}},"Delete")))}):[]))}),r}return S(t,[{key:"render",value:function(){var e=this,t=this.Component;return b.createElement("div",null,b.createElement(n.Button,{onClick:function(){return e.props.addNodeMutation({variables:{name:"name-"+(new Date).getTime(),value:"test:"+new Date},refetchQueries:["NodesQuery"]})}},"New"),b.createElement(t,{path:"/",types:["nt:unstructured"]}))}}]),t}(t.Component),J=g(U),z=g(W),K=g(X),Y=c.graphql(J,{name:"setPropertyMutation"})(c.graphql(z,{name:"addNodeMutation"})(c.graphql(K,{name:"removeNodeMutation"})(G))),Z=function(e){var t=this,r=e.headers?e.headers:function(){return b.createElement(n.TableRow,null,b.createElement(n.TableCell,null,"Name"))},a=e.row?e.row:function(r){return b.createElement(n.TableRow,{key:r.path},b.createElement(n.TableCell,null,e.textRenderer?e.textRenderer.call(t,r):r.name))};return b.createElement(n.Table,null,b.createElement(n.TableHead,null,r()),b.createElement(n.TableBody,null,e.nodes?e.nodes.map(a):[]))};Z.propTypes={headers:f.func,row:f.func,textRenderer:f.func,nodes:f.arrayOf(f.object)};e.PickerViewMaterial=function(e){var t=this;return b.createElement(n.List,null,e.pickerEntries.map(function(r){return b.createElement(n.ListItem,{button:!0,onClick:function(){return r.selectable?e.onSelectItem(r.path,!r.selected):e.onOpenItem(r.path,!r.open)},key:r.path},b.createElement(n.ListItemIcon,{style:r.selectable?{}:{opacity:0}},r.selected?b.createElement(v.RadioButtonChecked,null):b.createElement(v.RadioButtonUnchecked,null)),b.createElement(n.ListItemText,{style:{paddingLeft:r.depth*e.theme.spacing.unit},inset:!0,primary:e.textRenderer?e.textRenderer.call(t,r):r.name}),b.createElement(n.ListItemSecondaryAction,null,r.openable&&r.hasChildren?b.createElement(n.IconButton,{onClick:function(){return e.onOpenItem(r.path,!r.open)}},r.open?b.createElement(v.ExpandLess,null):b.createElement(v.ExpandMore,null)):null))}))},e.PickerViewMaterial.propTypes={pickerEntries:f.array.isRequired,onSelectItem:f.func,onOpenItem:f.func,textRenderer:f.func},e.PickerViewMaterial=n.withTheme()(e.PickerViewMaterial),e.PickerViewMaterialMultiple=function(e){var t=this;return b.createElement(n.List,null,e.pickerEntries.map(function(r){return b.createElement(n.ListItem,{button:!0,onClick:function(){return r.selectable?e.onSelectItem(r.path,!r.selected,!0):e.onOpenItem(r.path,!r.open)},key:r.path},b.createElement(n.ListItemIcon,{style:r.selectable?{}:{opacity:0}},r.selected?b.createElement(v.CheckBox,null):b.createElement(v.CheckBoxOutlineBlank,null)),b.createElement(n.ListItemText,{style:{paddingLeft:r.depth*e.theme.spacing.unit},inset:!0,primary:e.textRenderer?e.textRenderer.call(t,r):r.name}),b.createElement(n.ListItemSecondaryAction,null,r.openable&&r.hasChildren?b.createElement(n.IconButton,{onClick:function(){return e.onOpenItem(r.path,!r.open)}},r.open?b.createElement(v.ExpandLess,null):b.createElement(v.ExpandMore,null)):null))}))},e.PickerViewMaterialMultiple.propTypes={pickerEntries:f.array.isRequired,onSelectItem:f.func,onOpenItem:f.func,textRenderer:f.func},e.PickerViewMaterialMultiple=n.withTheme()(e.PickerViewMaterialMultiple);var ee=q(["\n            query PickerQuery($rootPaths:[String!]!, $selectable:[String]!, $openable:[String]!, $openPaths:[String!]!, $types:[String]!) {\n                jcr {\n                    rootNodes:nodesByPath(paths: $rootPaths) {\n                        path\n                        uuid\n                        name\n                        children(typesFilter:{types:$types}, limit:1) {\n                            pageInfo {\n                                totalCount\n                            }\n                        }\n                        selectable : isNodeType(type: {types:$selectable})\n                        openable : isNodeType(type: {types:$openable})\n                        ... node\n                    },\n                    openNodes:nodesByPath(paths: $openPaths) {\n                        path\n                        uuid\n                        children(typesFilter:{types:$types}) {\n                            nodes {\n                                path\n                                uuid\n                                name\n                                children(typesFilter:{types:$types}, limit:1) {\n                                    pageInfo {\n                                        totalCount\n                                    }\n                                }\n                                selectable : isNodeType(type: {types:$selectable})\n                                openable : isNodeType(type: {types:$openable})\n                                ... node\n                            }\n                        }\n                    }\n                }\n            }"],["\n            query PickerQuery($rootPaths:[String!]!, $selectable:[String]!, $openable:[String]!, $openPaths:[String!]!, $types:[String]!) {\n                jcr {\n                    rootNodes:nodesByPath(paths: $rootPaths) {\n                        path\n                        uuid\n                        name\n                        children(typesFilter:{types:$types}, limit:1) {\n                            pageInfo {\n                                totalCount\n                            }\n                        }\n                        selectable : isNodeType(type: {types:$selectable})\n                        openable : isNodeType(type: {types:$openable})\n                        ... node\n                    },\n                    openNodes:nodesByPath(paths: $openPaths) {\n                        path\n                        uuid\n                        children(typesFilter:{types:$types}) {\n                            nodes {\n                                path\n                                uuid\n                                name\n                                children(typesFilter:{types:$types}, limit:1) {\n                                    pageInfo {\n                                        totalCount\n                                    }\n                                }\n                                selectable : isNodeType(type: {types:$selectable})\n                                openable : isNodeType(type: {types:$openable})\n                                ... node\n                            }\n                        }\n                    }\n                }\n            }"]),te=function(e){_(t,e);function t(e){k(this,t);var n=$(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=g(ee),a=e.fragments,o=j(e,["fragments"]);s.replaceFragmentsInDocument(r,a),n.graphqlComponentProps=o;var i={},u=n;return e.openPaths||(i.openPaths=e.defaultOpenPaths?l.clone(e.defaultOpenPaths):[],o.onOpenItem=function(t,n){u.setState(function(e,r){return{openPaths:n?[].concat(I(e.openPaths),[t]):l.filter(e.openPaths,function(e){return e!==t})}}),e.onOpenItem&&e.onOpenItem(t,n)}),e.selectedPaths||(i.selectedPaths=e.defaultSelectedPaths?l.clone(e.defaultSelectedPaths):[],o.onSelectItem=function(t,n,r){u.setState(function(e,a){return{selectedPaths:n?[].concat(I(r?e.selectedPaths:[]),[t]):l.filter(e.selectedPaths,function(e){return e!==t})}}),e.onSelectItem&&e.onSelectItem(t,select,r)}),n.state=i,n.GraphQLComponent=c.graphql(r,{props:n.mapResultsToProps,options:n.mapPropsToOptions})(n.props.render),n}return S(t,[{key:"componentDidUpdate",value:function(e,t,n){this.props.onSelectionChange&&!l.isEqual(this.state.selectedPaths,t.selectedPaths)&&this.props.onSelectionChange(this.state.selectedPaths)}},{key:"componentWillReceiveProps",value:function(e,t){e.fragments,e.onOpenItem,e.onSelectItem;var n=j(e,["fragments","onOpenItem","onSelectItem"]);l.assign(this.graphqlComponentProps,n)}},{key:"mapResultsToProps",value:function(e){var t=e.data,n=e.ownProps,r=n.selectedPaths,a=n.openPaths?n.openPaths:[],o=[],i={},u=t.jcr,s=function(e,t,n){var u=!1;e.selectable&&(u=-1!==l.indexOf(r,e.path));var s={name:e.name,path:e.path,open:e.openable&&-1!==l.indexOf(a,e.path),selected:u,openable:e.openable,selectable:e.selectable,depth:t,prefix:l.repeat("&nbsp;",3*t),node:e,hidden:!1,hasChildren:e.children.pageInfo.totalCount>0};return o.splice(n,0,s),i[e.uuid]=s,s};u&&(u.rootNodes&&l.forEach(u.rootNodes,function(e){s(e,0,0).hidden=n.hideRoot}),u.openNodes&&l.sortBy(u.openNodes,["path"]).forEach(function(e){var t=i[e.uuid];if(t){var n=l.indexOf(o,t);l.forEachRight(e.children.nodes,function(e){s(e,t.depth+1,n+1)})}}));var c=l.filter(o,function(e){return e.selected}).map(function(e){return e.node});return r=l.map(c,"path"),o=l.filter(o,function(e){return!e.hidden}),w({},n,{pickerEntries:o})}},{key:"mapPropsToOptions",value:function(e){var t=e.openPaths?e.openPaths:[];e.selectedPaths&&l.each(e.selectedPaths,function(n){return function(e,n){var r=!1;l.tail(l.split(n,"/")).reduce(function(n,a){return r||l.forEach(e.rootPaths,function(e){r=r||l.startsWith(n,e)}),r&&-1===l.indexOf(t,n)&&t.push(n),n+"/"+a},"")}(e,n)});var n={rootPaths:e.rootPaths,types:l.union(e.openableTypes,e.selectableTypes),selectable:e.selectableTypes,openable:e.openableTypes,openPaths:t};return e.queryVariables&&l.assign(n,e.queryVariables),{variables:n}}},{key:"render",value:function(){var e=this.GraphQLComponent;return b.createElement(e,w({},this.graphqlComponentProps,this.state))}}]),t}(b.Component);te.propTypes={rootPaths:f.arrayOf(f.string).isRequired,defaultOpenPaths:f.arrayOf(f.string),openableTypes:f.arrayOf(f.string).isRequired,openPaths:f.arrayOf(f.string),selectableTypes:f.arrayOf(f.string).isRequired,defaultSelectedPaths:f.arrayOf(f.string),selectedPaths:f.arrayOf(f.string),onSelectionChange:f.func,render:f.func,fragments:f.arrayOf(f.oneOfType([f.string,f.shape({applyFor:f.string.isRequired,variables:f.string,gql:f.object.isRequired})])),queryVariables:f.object},e.DxContextProvider=M,e.withDxContext=function(){return function(e){var t=function(t){_(n,t);function n(){return k(this,n),$(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return S(n,[{key:"render",value:function(){return b.createElement(e,w({dxContext:this.context.dxContext},this.props))}}]),n}(b.Component);return t.contextTypes={dxContext:f.object},t}},e.DynamicComponentsList=D,e.SimpleListView=B,e.getI18n=P,e.TestLayout=Q,e.MutationExample=Y,e.NodesTableViewMaterial=Z,e.withNodesFromPath=A,e.withPathFromSelection=function(e){return function(t){return p.connect(function(t,n){return w({},n,{path:t["selectedPaths_"+e]&&1===t["selectedPaths_"+e].length?t["selectedPaths_"+e][0]:null})},function(){return{}})(t)}},e.Picker=te,e.createOutletHistory=T,e.OutletRouter=R,e.RouterExample=L,e.reducers=E,e.store=O,e.resetStateReducer=function(e,t){if("RESET_STATE"!==t.type)return e},e.theme=x,Object.defineProperty(e,"__esModule",{value:!0})});