!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("material-ui"),require("i18next"),require("i18next-xhr-backend"),require("react-i18next"),require("redux"),require("lodash"),require("@jahia/apollo-dx"),require("react-apollo"),require("react-redux"),require("react-router-dom"),require("history"),require("react-router"),require("prop-types"),require("react-dom"),require("graphql-tag"),require("material-ui-icons")):"function"==typeof define&&define.amd?define(["exports","react","material-ui","i18next","i18next-xhr-backend","react-i18next","redux","lodash","@jahia/apollo-dx","react-apollo","react-redux","react-router-dom","history","react-router","prop-types","react-dom","graphql-tag","material-ui-icons"],t):t((e.jahia=e.jahia||{},e.jahia.reactcomponents={}),e.React,e.materialUi,e.i18n,e.XHR,e.reactI18next,e.redux,e._,e.jahia.apollodx,e.reactApollo,e.reactRedux,e.reactRouterDom,e.history,e.reactRouter,e.PropTypes,e.ReactDOM,e.gql,e.materialUiIcons)}(this,function(e,t,n,r,a,o,l,i,u,c,s,p,d,h,m,y,f,E){"use strict";var v="default"in t?t.default:t;r=r&&r.hasOwnProperty("default")?r.default:r,a=a&&a.hasOwnProperty("default")?a.default:a,m=m&&m.hasOwnProperty("default")?m.default:m,y=y&&y.hasOwnProperty("default")?y.default:y,f=f&&f.hasOwnProperty("default")?f.default:f;function P(e){return e=e||{},r.use(a).init({lng:e.currentLanguage?e.currentLanguage:void 0,fallbackLng:"en",debug:!0,interpolation:{escapeValue:!1},react:{wait:!1,bindI18n:"languageChanged loaded",bindStore:"added removed",nsMode:"default"},backend:{loadPath:(e.contextPath?e.contextPath:"")+"/modules/{{ns}}/javascript/locales/{{lng}}.json"}}),r}var b={},g=function(){var e=void 0;return"undefined"!=typeof window&&(e=window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__({name:"DX Redux",instanceId:"dx"})),l.createStore(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];return i.mapValues(b,function(n,r){return n(e[r],t)})},e)}(),_=function(e,t){if("RESET_STATE"!==t.type)return e},T=n.createMuiTheme();console.log(T);function C(e,t){var n=this,r=function(n){var r=[],a=e.location.pathname,o=t+":"+n;return a.indexOf("(")>-1&&(r=(a=(a=a.substr(a.indexOf("(")+1)).substr(0,a.indexOf(")"))).split("//"),r=i.map(r,function(e){return e.startsWith(t+":")?o:e})),-1===r.indexOf(o)&&r.push(o),"/("+i.join(r,"//")+")"},a=function(n){var r=void 0;return n?(r=e.location.state?e.location.state:{})["router_"+t]=n:e.location.state&&delete(r=e.location.state)["router_"+t],r},o=function(e){if(e.indexOf("(")>-1){var n=(e=(e=e.substr(e.indexOf("(")+1)).substr(0,e.indexOf(")"))).split("//"),r=t+":",a=i.find(n,function(e){return e.startsWith(r)});if(a)return a.substr(r.length)}return""},l=i.clone(e.location);l.pathname=o(l.pathname);var u=[],c={length:e.length,action:e.action,location:l,createHref:function(t){return e.createHref({pathname:r(t.pathname)})},push:function(t,n){return e.push(r(t),a(n))},replace:function(t,n){e.replace(r(t),a(n))},go:function(t){e.go(t)},goBack:function(){e.goBack()},goForward:function(){e.goForward()},block:function(t){return e.block(t)},listen:function(e){return u.push(e),function(){i.pull(u,e)}},dispose:function(){s()}},s=e.listen(function(e){var r=o(e.pathname),a=void 0;e.state&&e.state["router_"+t]&&(a=e.state["router_"+t]),c.location.pathname===r&&c.location.state===a||(Object.assign(c.location,e),c.location.pathname=r,c.location.state=a,i.each(u,function(e){return e.call(n,c.location)}))});return c}var O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},S=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},I=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},N=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},w=function(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))},R=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},$=d.createHashHistory(),j=function(e){I(t,e);function t(e){x(this,t);var n=N(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.outletHistory=C($,e.outlet),n}return S(t,[{key:"componentWillMount",value:function(){}},{key:"componentWillUnmount",value:function(){this.outletHistory.dispose()}},{key:"render",value:function(){return v.createElement(h.Router,{history:this.outletHistory},this.props.children)}}]),t}(v.Component),q=function(e){I(t,e);function t(e){return x(this,t),N(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return S(t,[{key:"render",value:function(){return v.createElement(j,{outlet:this.props.id},v.createElement("div",null,v.createElement(p.Link,{to:"/test1/value1"},"test1/value1"),v.createElement(p.Link,{to:"/test1/value2"},"Test1/value2"),v.createElement(p.Link,{to:"/test2"},"test2"),v.createElement(p.Link,{to:"/test3"},"test3"),v.createElement(p.Route,{path:"/test1/:value",component:function(e){return v.createElement(n.Paper,{elevation:4},v.createElement(n.Typography,{type:"headline",component:"h3"},"Page 1"),v.createElement(n.Typography,{component:"p"},"Param = ",e.match.params.value))}}),v.createElement(p.Route,{path:"/test2",component:function(e){return v.createElement(n.Paper,{elevation:4},v.createElement(n.Typography,{type:"headline",component:"h3"},"Page 2"))}}),v.createElement(p.Route,{path:"/test3",component:function(e){return v.createElement(n.Paper,{elevation:4},v.createElement(n.Typography,{type:"headline",component:"h3"},"Page 3"))}})))}}]),t}(v.Component),L=function(e){I(t,e);function t(e){return x(this,t),N(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return S(t,[{key:"getChildContext",value:function(){return{dxContext:this.props.dxContext}}},{key:"render",value:function(){var e=this.props,t=e.dxContext,r=e.children,a=e.i18n,l=e.apollo,i=e.redux,d=e.mui,h=e.router,m=v.Children.only(r);if(a){var y={currentLanguage:t.uilang,contextPath:t.contextPath};"object"===(void 0===a?"undefined":O(a))&&Object.assign(y,a),m=v.createElement(o.I18nextProvider,{i18n:P(y)},m)}if(h){var f=p.HashRouter,E={};"object"===(void 0===f?"undefined":O(f))&&"outlet"===f.type&&(f=j,E.outlet=f.outlet),m=v.createElement(p.HashRouter,E,m)}if(l){var b={contextPath:t.contextPath};"object"===(void 0===l?"undefined":O(l))&&Object.assign(b,l),m=v.createElement(c.ApolloProvider,{client:u.client(b)},m)}return i&&(m=v.createElement(s.Provider,{store:g},m)),d&&(m=v.createElement(n.MuiThemeProvider,{theme:T},m)),m}}]),t}(v.Component);L.childContextTypes={dxContext:m.object};var M=function(e){I(t,e);function t(e){x(this,t);var n=N(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={reactElements:[]},n}return S(t,[{key:"componentDidMount",value:function(){var e=this;this.props.components&&!this.done&&this.props.components.then(function(t){e.done=!0,e.setState({reactElements:t})})}},{key:"componentDidUpdate",value:function(){this.componentDidMount()}},{key:"render",value:function(){return this.done?v.createElement("div",null,this.state.reactElements):v.createElement("div",null)}}]),t}(v.Component),B=w(['\n                query ComponentsQuery($query:String!) {\n                    jcr {\n                        nodesByQuery(query:$query) {\n                            nodes {\n                                name\n                                path\n                                primaryNodeType {\n                                    name\n                                }\n                                children {\n                                    nodes {\n                                        name\n                                        path\n                                        primaryNodeType {\n                                            name\n                                        }\n                                        renderedView(templateType:"js", view:"react") {\n                                            output\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }'],['\n                query ComponentsQuery($query:String!) {\n                    jcr {\n                        nodesByQuery(query:$query) {\n                            nodes {\n                                name\n                                path\n                                primaryNodeType {\n                                    name\n                                }\n                                children {\n                                    nodes {\n                                        name\n                                        path\n                                        primaryNodeType {\n                                            name\n                                        }\n                                        renderedView(templateType:"js", view:"react") {\n                                            output\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }']),V=function(e){I(t,e);function t(e){x(this,t);var n=N(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.componentCache=[],n}return S(t,[{key:"mapResultsToProps",value:function(e){var t=e.data,n=e.ownProps,r=[],a=t.jcr,o=eval;a&&a.nodesByQuery&&(r=i.map(i.flatMap(a.nodesByQuery.nodes,"children.nodes"),function(e){return o("("+e.renderedView.output+")")}));var l=[];i.each(r,function(e){l=l.concat(e.getImports())});var u=void 0;return l.length>0&&(u=Promise.all(i.map(l,function(e){return SystemJS.import(e)})).then(function(e){return i.map(r,function(t){var n=t.getImports().length,r=t.createElement.apply(t,[v,y].concat(R(e)));return e.splice(n),r})})),k({},n,{components:u})}},{key:"mapPropsToOptions",value:function(e){return{variables:{query:"select * from [reactnt:componentsFolder] where [react:id]='"+e.id+"'"}}}},{key:"render",value:function(){var e=this.props.renderComponent,t=i.find(this.componentCache,function(t){return t.renderComponent===e}),n=void 0;if(t)n=t.dataComponent;else{var r=f(B);n=c.graphql(r,{props:this.mapResultsToProps,options:this.mapPropsToOptions})(e||M),this.componentCache.push({renderComponent:e,dataComponent:n})}return v.createElement(n,this.props)}}]),t}(v.Component);V.propTypes={id:m.string.isRequired,renderComponent:m.element},e.LanguageSwitcher=function(e){I(t,e);function t(e,n){x(this,t);var r=N(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.state={anchorEl:null},r}return S(t,[{key:"handleClick",value:function(e){this.setState({anchorEl:e.target})}},{key:"handleClose",value:function(e){this.setState({anchorEl:null}),e&&this.context.i18n.changeLanguage(e)}},{key:"render",value:function(){var e=this;return v.createElement("div",null,v.createElement(n.Button,{onClick:this.handleClick.bind(this)},this.props.t("label.languages")),v.createElement(n.Menu,{open:Boolean(this.state.anchorEl),onClose:this.handleClose.bind(this,null),anchorEl:this.state.anchorEl},["fr","en"].map(function(t){return v.createElement(n.MenuItem,{onClick:e.handleClose.bind(e,t),key:t,value:t},t)})))}}]),t}(v.Component),e.LanguageSwitcher.contextTypes={i18n:m.object},e.LanguageSwitcher=o.translate("react-dxcomponents")(e.LanguageSwitcher);var D=function(e){return v.createElement(n.Grid,{container:!0},v.createElement(n.Grid,{item:!0,xs:12,md:6},v.createElement(n.Paper,null," ",e.leftCol)),v.createElement(n.Grid,{item:!0,xs:12,md:6},v.createElement(n.Paper,null,e.rightCol)))};D.propTypes={leftCol:m.element,rightCol:m.element};var F=w(["\n            query NodesQuery($path:String!, $types:[String]!) {\n                jcr {\n                    node:nodeByPath(path: $path) {\n                        path\n                        uuid\n                        name\n                        children(typesFilter:{types:$types}) {\n                            nodes {\n                                path\n                                uuid\n                                name\n                                ... node\n                            }\n                        }\n                    }\n                }\n            }"],["\n            query NodesQuery($path:String!, $types:[String]!) {\n                jcr {\n                    node:nodeByPath(path: $path) {\n                        path\n                        uuid\n                        name\n                        children(typesFilter:{types:$types}) {\n                            nodes {\n                                path\n                                uuid\n                                name\n                                ... node\n                            }\n                        }\n                    }\n                }\n            }"]);function Q(e){return function(t){var n=f(F);return u.replaceFragmentsInDocument(n,e),c.graphql(n,{props:function(e){var t=e.data,n=e.ownProps,r=[],a=t.jcr;return a&&a.node&&(r=a.node.children.nodes),k({},n,{nodes:r})},options:function(e){var t={path:e.path,types:e.types};return e.queryVariables&&i.assign(t,e.queryVariables),{variables:t,skip:!e.path}}})(t)}}var U=w(['fragment Test on JCRNode {\n                myprop:property(name:"myprop") {\n                    value\n                }\n            }'],['fragment Test on JCRNode {\n                myprop:property(name:"myprop") {\n                    value\n                }\n            }']),H=w(['\n    mutation setProperty($value:String,$path:String!) {\n        jcr {\n            mutateNode(pathOrId:$path) {\n                mutateProperty(name:"myprop") {\n                    setValue(value:$value)\n                }\n                node {\n                    path\n                }\n            }\n        }\n    }\n'],['\n    mutation setProperty($value:String,$path:String!) {\n        jcr {\n            mutateNode(pathOrId:$path) {\n                mutateProperty(name:"myprop") {\n                    setValue(value:$value)\n                }\n                node {\n                    path\n                }\n            }\n        }\n    }\n']),A=w(['\n    mutation addNode($value:String, $name:String!) {\n        jcr {\n            addNode(parentPathOrId:"/",name:$name,primaryNodeType:"nt:unstructured") {\n                mutateProperty(name:"myprop") {\n                    setValue(value:$value)\n                }\n            }\n        }\n    }\n'],['\n    mutation addNode($value:String, $name:String!) {\n        jcr {\n            addNode(parentPathOrId:"/",name:$name,primaryNodeType:"nt:unstructured") {\n                mutateProperty(name:"myprop") {\n                    setValue(value:$value)\n                }\n            }\n        }\n    }\n']),K=w(["\n    mutation removeNode($path:String!) {\n        jcr {\n            deleteNode(pathOrId:$path)\n        }\n    }\n"],["\n    mutation removeNode($path:String!) {\n        jcr {\n            deleteNode(pathOrId:$path)\n        }\n    }\n"]),Y=function(e){I(t,e);function t(e){x(this,t);var r=N(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.Component=Q([{applyFor:"node",gql:f(U)}])(function(e){return v.createElement(n.Table,null,v.createElement(n.TableHead,null,v.createElement(n.TableRow,null,v.createElement(n.TableCell,null,"Name"),v.createElement(n.TableCell,null,"Value"),v.createElement(n.TableCell,null,"Update"),v.createElement(n.TableCell,null,"Delete"))),v.createElement(n.TableBody,null,e.nodes?e.nodes.map(function(e){return v.createElement(n.TableRow,{key:e.uuid},v.createElement(n.TableCell,null,e.name),v.createElement(n.TableCell,null,e.myprop.value),v.createElement(n.TableCell,null,v.createElement(n.Button,{onClick:function(){return r.props.setPropertyMutation({variables:{path:e.path,value:"test:"+new Date},refetchQueries:["NodesQuery"]})}},"Update")),v.createElement(n.TableCell,null,v.createElement(n.Button,{onClick:function(){return r.props.removeNodeMutation({variables:{path:e.path},refetchQueries:["NodesQuery"]})}},"Delete")))}):[]))}),r}return S(t,[{key:"render",value:function(){var e=this,t=this.Component;return v.createElement("div",null,v.createElement(n.Button,{onClick:function(){return e.props.addNodeMutation({variables:{name:"name-"+(new Date).getTime(),value:"test:"+new Date},refetchQueries:["NodesQuery"]})}},"New"),v.createElement(t,{path:"/",types:["nt:unstructured"]}))}}]),t}(t.Component),W=f(H),X=f(A),G=f(K),J=c.graphql(W,{name:"setPropertyMutation"})(c.graphql(X,{name:"addNodeMutation"})(c.graphql(G,{name:"removeNodeMutation"})(Y))),z=function(e){var t=this,r=e.headers?e.headers:function(){return v.createElement(n.TableRow,null,v.createElement(n.TableCell,null,"Name"))},a=e.row?e.row:function(r){return v.createElement(n.TableRow,{key:r.path},v.createElement(n.TableCell,null,e.textRenderer?e.textRenderer.call(t,r):r.name))};return v.createElement(n.Table,null,v.createElement(n.TableHead,null,r()),v.createElement(n.TableBody,null,e.nodes?e.nodes.map(a):[]))};z.propTypes={headers:m.func,row:m.func,textRenderer:m.func,nodes:m.arrayOf(m.object)};var Z=w(["\n            query PickerQuery($rootPaths:[String!]!, $selectable:[String]!, $openable:[String]!, $openPaths:[String!]!, $types:[String]!) {\n                jcr {\n                    rootNodes:nodesByPath(paths: $rootPaths) {\n                        path\n                        uuid\n                        name\n                        children(typesFilter:{types:$types}, limit:1) {\n                            pageInfo {\n                                totalCount\n                            }\n                        }\n                        selectable : isNodeType(type: {types:$selectable})\n                        openable : isNodeType(type: {types:$openable})\n                        ... node\n                    },\n                    openNodes:nodesByPath(paths: $openPaths) {\n                        path\n                        uuid\n                        children(typesFilter:{types:$types}) {\n                            nodes {\n                                path\n                                uuid\n                                name\n                                children(typesFilter:{types:$types}, limit:1) {\n                                    pageInfo {\n                                        totalCount\n                                    }\n                                }\n                                selectable : isNodeType(type: {types:$selectable})\n                                openable : isNodeType(type: {types:$openable})\n                                ... node\n                            }\n                        }\n                    }\n                }\n            }"],["\n            query PickerQuery($rootPaths:[String!]!, $selectable:[String]!, $openable:[String]!, $openPaths:[String!]!, $types:[String]!) {\n                jcr {\n                    rootNodes:nodesByPath(paths: $rootPaths) {\n                        path\n                        uuid\n                        name\n                        children(typesFilter:{types:$types}, limit:1) {\n                            pageInfo {\n                                totalCount\n                            }\n                        }\n                        selectable : isNodeType(type: {types:$selectable})\n                        openable : isNodeType(type: {types:$openable})\n                        ... node\n                    },\n                    openNodes:nodesByPath(paths: $openPaths) {\n                        path\n                        uuid\n                        children(typesFilter:{types:$types}) {\n                            nodes {\n                                path\n                                uuid\n                                name\n                                children(typesFilter:{types:$types}, limit:1) {\n                                    pageInfo {\n                                        totalCount\n                                    }\n                                }\n                                selectable : isNodeType(type: {types:$selectable})\n                                openable : isNodeType(type: {types:$openable})\n                                ... node\n                            }\n                        }\n                    }\n                }\n            }"]);e.PickerViewMaterial=function(e){var t=this;return v.createElement(n.List,null,e.pickerEntries.map(function(r){return v.createElement(n.ListItem,{button:!0,onClick:function(){return r.selectable?e.onSelectItem(r.path,!r.selected):e.onOpenItem(r.path,!r.open)},key:r.path},v.createElement(n.ListItemIcon,{style:r.selectable?{}:{opacity:0}},r.selected?v.createElement(E.RadioButtonChecked,null):v.createElement(E.RadioButtonUnchecked,null)),v.createElement(n.ListItemText,{style:{paddingLeft:r.depth*e.theme.spacing.unit},inset:!0,primary:e.textRenderer?e.textRenderer.call(t,r):r.name}),v.createElement(n.ListItemSecondaryAction,null,r.openable&&r.hasChildren?v.createElement(n.IconButton,{onClick:function(){return e.onOpenItem(r.path,!r.open)}},r.open?v.createElement(E.ExpandLess,null):v.createElement(E.ExpandMore,null)):null))}))},e.PickerViewMaterial.propTypes={pickerEntries:m.array.isRequired,onSelectItem:m.func,onOpenItem:m.func,textRenderer:m.func},e.PickerViewMaterial=n.withTheme()(e.PickerViewMaterial),e.PickerViewMaterialMultiple=function(e){var t=this;return v.createElement(n.List,null,e.pickerEntries.map(function(r){return v.createElement(n.ListItem,{button:!0,onClick:function(){return r.selectable?e.onSelectItem(r.path,!r.selected,!0):e.onOpenItem(r.path,!r.open)},key:r.path},v.createElement(n.ListItemIcon,{style:r.selectable?{}:{opacity:0}},r.selected?v.createElement(E.CheckBox,null):v.createElement(E.CheckBoxOutlineBlank,null)),v.createElement(n.ListItemText,{style:{paddingLeft:r.depth*e.theme.spacing.unit},inset:!0,primary:e.textRenderer?e.textRenderer.call(t,r):r.name}),v.createElement(n.ListItemSecondaryAction,null,r.openable&&r.hasChildren?v.createElement(n.IconButton,{onClick:function(){return e.onOpenItem(r.path,!r.open)}},r.open?v.createElement(E.ExpandLess,null):v.createElement(E.ExpandMore,null)):null))}))},e.PickerViewMaterialMultiple.propTypes={pickerEntries:m.array.isRequired,onSelectItem:m.func,onOpenItem:m.func,textRenderer:m.func},e.PickerViewMaterialMultiple=n.withTheme()(e.PickerViewMaterialMultiple),e.DxContextProvider=L,e.DynamicComponentsList=V,e.SimpleListView=M,e.getI18n=P,e.TestLayout=D,e.MutationExample=J,e.NodesTableViewMaterial=z,e.withNodesFromPath=Q,e.withPathFromSelection=function(e){return function(t){return s.connect(function(t,n){return k({},n,{path:t["selectedPaths_"+e]&&1===t["selectedPaths_"+e].length?t["selectedPaths_"+e][0]:null})},function(){return{}})(t)}},e.withPickerModel=function(e,t){return function(n){var r=f(Z);u.replaceFragmentsInDocument(r,e);var a=c.graphql(r,{props:function(e){var t=e.data,n=e.ownProps,r=n.selectedPaths,a=n.openPaths?n.openPaths:[],o=[],l={},u=t.jcr,c=function(e,t,n){var u=!1;e.selectable&&(u=-1!==i.indexOf(r,e.path));var c={name:e.name,path:e.path,open:e.openable&&-1!==i.indexOf(a,e.path),selected:u,openable:e.openable,selectable:e.selectable,depth:t,prefix:i.repeat("&nbsp;",3*t),node:e,hidden:!1,hasChildren:e.children.pageInfo.totalCount>0};return o.splice(n,0,c),l[e.uuid]=c,c};u&&(u.rootNodes&&i.forEach(u.rootNodes,function(e){c(e,0,0).hidden=n.hideRoot}),u.openNodes&&i.sortBy(u.openNodes,["path"]).forEach(function(e){var t=l[e.uuid];if(t){var n=i.indexOf(o,t);i.forEachRight(e.children.nodes,function(e){c(e,t.depth+1,n+1)})}}));var s=i.filter(o,function(e){return e.selected}).map(function(e){return e.node});return r=i.map(s,"path"),o=i.filter(o,function(e){return!e.hidden}),k({},n,{pickerEntries:o})},options:function(e){var t=e.openPaths?e.openPaths:[];e.selectedPaths&&i.each(e.selectedPaths,function(n){return function(e,n){var r=!1;i.tail(i.split(n,"/")).reduce(function(n,a){return r||i.forEach(e.rootPaths,function(e){r=r||i.startsWith(n,e)}),r&&-1===i.indexOf(t,n)&&t.push(n),n+"/"+a},"")}(e,n)});var n={rootPaths:e.rootPaths,types:i.union(e.openableTypes,e.selectableTypes),selectable:e.selectableTypes,openable:e.openableTypes,openPaths:t};return e.queryVariables&&i.assign(n,e.queryVariables),{variables:n}}})(n);if(t){var o=s.connect(function(e,n){return k({},n,{openPaths:e["openPaths_"+t]?e["openPaths_"+t]:n.openPaths,selectedPaths:e["selectedPaths_"+t]?e["selectedPaths_"+t]:n.selectedPaths})},function(e,n){return{onSelectItem:function(n,r,a){e({type:r?"SELECT_PICKER_ENTRY_"+(a?"MULTIPLE_":"SINGLE_")+t:"UNSELECT_PICKER_ENTRY_"+t,path:n})},onOpenItem:function(n,r){e({type:r?"OPEN_PICKER_ENTRY_"+t:"CLOSE_PICKER_ENTRY_"+t,path:n})}}})(a);return function(e){I(n,e);function n(e){return x(this,n),N(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e))}return S(n,[{key:"componentWillMount",value:function(){var e=this;b["openPaths_"+t]=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.props.openPaths||[],r=arguments[1],a=n.indexOf(r.path);return r.type==="OPEN_PICKER_ENTRY_"+t&&-1===a?[].concat(R(n),[r.path]):r.type==="CLOSE_PICKER_ENTRY_"+t&&-1!==a?i.filter(n,function(e){return e!==r.path}):n},b["selectedPaths_"+t]=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.props.selectedPaths||[],r=arguments[1],a=n.indexOf(r.path);return r.type==="SELECT_PICKER_ENTRY_MULTIPLE_"+t&&-1===a?[].concat(R(n),[r.path]):r.type==="SELECT_PICKER_ENTRY_SINGLE_"+t?[r.path]:r.type==="UNSELECT_PICKER_ENTRY_"+t&&-1!==a?i.filter(n,function(e){return e!==r.path}):n}}},{key:"componentWillUnmount",value:function(){b["openPaths_"+t]=_,b["selectedPaths_"+t]=_,g.dispatch({type:"RESET_STATE"}),delete b["openPaths_"+t],delete b["selectedPaths_"+t]}},{key:"render",value:function(){return v.createElement(o,this.props)}}]),n}(v.Component)}return function(e){I(t,e);function t(e){x(this,t);var n=N(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={openPaths:e.openPaths?e.openPaths:[],selectedPaths:e.selectedPaths?e.selectedPaths:e.selectedPath?[e.selectedPath]:[]},n}return S(t,[{key:"onSelectItem",value:function(e,t,n,r){this.setState({openPaths:e.openPaths,selectedPaths:n?[].concat(R(r?e.selectedPaths:[]),[t]):i.filter(e.selectedPaths,function(e){return e!==t})})}},{key:"onOpenItem",value:function(e,t,n){this.setState({openPaths:n?[].concat(R(e.openPaths),[t]):i.filter(e.openPaths,function(e){return e!==t}),selectedPaths:e.selectedPaths})}},{key:"render",value:function(){return v.createElement(a,k({},this.props,{onOpenItem:this.onOpenItem.bind(this,this.state),onSelectItem:this.onSelectItem.bind(this,this.state),openPaths:this.state.openPaths,selectedPaths:this.state.selectedPaths}))}}]),t}(v.Component)}},e.createOutletHistory=C,e.OutletRouter=j,e.RouterExample=q,e.reducers=b,e.store=g,e.resetStateReducer=_,e.theme=T,Object.defineProperty(e,"__esModule",{value:!0})});