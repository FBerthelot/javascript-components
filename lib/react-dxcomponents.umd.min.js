!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("material-ui"),require("material-ui/styles/index"),require("i18next"),require("i18next-xhr-backend"),require("react-i18next"),require("redux"),require("lodash"),require("material-ui/colors/index"),require("@jahia/apollo-dx"),require("react-apollo"),require("react-redux"),require("react-router-dom"),require("history"),require("react-router"),require("prop-types"),require("react-jss"),require("material-ui-icons"),require("graphql-tag"),require("material-ui/styles/colorManipulator")):"function"==typeof define&&define.amd?define(["exports","react","material-ui","material-ui/styles/index","i18next","i18next-xhr-backend","react-i18next","redux","lodash","material-ui/colors/index","@jahia/apollo-dx","react-apollo","react-redux","react-router-dom","history","react-router","prop-types","react-jss","material-ui-icons","graphql-tag","material-ui/styles/colorManipulator"],t):t((e.jahia=e.jahia||{},e.jahia.reactcomponents={}),e.React,e.materialUi,e.materialUiStyles,e.i18n,e.XHR,e.reactI18next,e.redux,e._,e.index$1,e.jahia.apollodx,e.reactApollo,e.reactRedux,e.reactRouterDom,e.history,e.reactRouter,e.PropTypes,e.reactJss,e.materialUiIcons,e.gql,e.colorManipulator)}(this,function(e,t,y,m,n,r,g,o,u,a,p,b,x,v,i,s,l,P,c,h,d){"use strict";var k="default"in t?t.default:t;function C(e){return e=e||{},n.use(r).init({lng:e.currentLanguage?e.currentLanguage:void 0,fallbackLng:"en",debug:!0,interpolation:{escapeValue:!1},react:{wait:!1,bindI18n:"languageChanged loaded",bindStore:"added removed",nsMode:"default"},backend:{loadPath:(e.contextPath?e.contextPath:"")+"/modules/{{ns}}/javascript/locales/{{lng}}.json"}}),n}n=n&&n.hasOwnProperty("default")?n.default:n,r=r&&r.hasOwnProperty("default")?r.default:r,l=l&&l.hasOwnProperty("default")?l.default:l,h=h&&h.hasOwnProperty("default")?h.default:h;var f,O={},E=(f=void 0,"undefined"!=typeof window&&(f=window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__({name:"DX Redux",instanceId:"dx"})),o.createStore(function(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=arguments[1];return u.mapValues(O,function(e,t){return e(n[t],r)})},f)),S=y.createMuiTheme({palette:{background:{global:a.grey[200]},contrastThreshold:2.5,tonalOffset:.2,primary:{main:a.blueGrey[600]},secondary:{main:a.lightBlue[600]},error:{main:a.red[400]},publish:{main:a.deepOrange[500]},enabled:{main:a.green[400]},delete:{main:a.red[600]}},overrides:{MuiButton:{root:{color:"inherit"}},MuiTableCell:{body:{color:"inherit"}},MuiIconButton:{root:{color:"inherit"}},MuiCheckbox:{default:{color:"inherit"}}}}),T=y.createMuiTheme({palette:{type:"dark",background:{global:a.grey[900]},contrastThreshold:3,tonalOffset:.2,primary:{main:a.purple[500]},secondary:{main:a.green[400]},error:{main:a.red[200]},publish:{main:a.deepOrange[500]},enabled:{main:a.green[400]},delete:{main:a.red[600]}},overrides:{MuiButton:{root:{color:"inherit"}},MuiTableCell:{body:{color:"inherit"}},MuiIconButton:{root:{color:"inherit"}},MuiCheckbox:{default:{color:"inherit"}}}}),w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},j=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),I=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},q=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},$=function(e,t){var n={};for(var r in e)0<=t.indexOf(r)||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n},B=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},R=function(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))},N=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)};function M(o,a){var r=this,n=function(e){var t=[],n=o.location.pathname,r=a+":"+e;return-1<n.indexOf("(")&&(t=(n=(n=n.substr(n.indexOf("(")+1)).substr(0,n.indexOf(")"))).split("//"),t=u.map(t,function(e){return e.startsWith(a+":")?r:e})),-1===t.indexOf(r)&&t.push(r),"/("+u.join(t,"//")+")"},i=function(e){var t=void 0;return e?(t=o.location.state?o.location.state:{})["router_"+a]=e:o.location.state&&delete(t=o.location.state)["router_"+a],t},s=function(e){if(-1<e.indexOf("(")){var t=(e=(e=e.substr(e.indexOf("(")+1)).substr(0,e.indexOf(")"))).split("//"),n=a+":",r=u.find(t,function(e){return e.startsWith(n)});if(r)return r.substr(n.length)}return""},e=u.clone(o.location);e.pathname=s(e.pathname);var l=[],c={length:o.length,action:o.action,location:e,createHref:function(e){return o.createHref({pathname:n(e.pathname)})},push:function(e,t){return o.push(n(e),i(t))},replace:function(e,t){o.replace(n(e),i(t))},go:function(e){o.go(e)},goBack:function(){o.goBack()},goForward:function(){o.goForward()},block:function(e){return o.block(e)},listen:function(e){return l.push(e),function(){u.pull(l,e)}},dispose:function(){t()}},t=o.listen(function(e){var t=s(e.pathname),n=void 0;e.state&&e.state["router_"+a]&&(n=e.state["router_"+a]),c.location.pathname===t&&c.location.state===n||(Object.assign(c.location,e),c.location.pathname=t,c.location.state=n,u.each(l,function(e){return e.call(r,c.location)}))});return c}e.ThemeTester=function(e){function n(e){_(this,n);var t=B(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.switch=t.switch.bind(t),t.themes=[S,T],t.state={checked:!1},t}return q(n,e),j(n,[{key:"switch",value:function(){var t=this;this.setState(function(e){return t.props.dxContext.setTheme(e.checked?S:T),{checked:!e.checked}})}},{key:"render",value:function(){return k.createElement(y.Switch,{color:"default",onChange:this.switch,checked:this.state.checked})}}]),n}(k.Component),e.ThemeTester=D()(e.ThemeTester);var L=function(e){function r(e){_(this,r);var t=B(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e)),n=i.createHashHistory();return t.outletHistory=M(n,e.outlet),t}return q(r,e),j(r,[{key:"componentWillMount",value:function(){}},{key:"componentWillUnmount",value:function(){this.outletHistory.dispose()}},{key:"render",value:function(){return k.createElement(s.Router,{history:this.outletHistory},this.props.children)}}]),r}(k.Component),F=function(e){function r(e){_(this,r);var t=B(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e)),n=t.props.notificationContext;return t.state={notification:{message:"",open:!1}},n.notify=function(e){t.setState({notification:{message:e,open:!0}})},n.closeNotification=function(){t.setState({notification:{message:"",open:!1}})},t}return q(r,e),j(r,[{key:"getChildContext",value:function(){return{notificationContext:this.props.notificationContext}}},{key:"render",value:function(){return k.createElement("div",null,this.props.children,k.createElement(y.Snackbar,{anchorOrigin:{vertical:"bottom",horizontal:"left"},autoHideDuration:5e3,onClose:this.props.notificationContext.closeNotification,open:this.state.notification.open,SnackbarContentProps:{"aria-describedby":"message-id"},message:k.createElement("span",{id:"message-id"},this.state.notification.message)}))}}]),r}(t.Component);F.propTypes={notificationContext:l.object.isRequired},F.childContextTypes={notificationContext:l.object.isRequired};var V=function(e){function c(e){_(this,c);var t=B(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,e)),n=t.props,r=n.dxContext,o=(n.children,n.i18n,n.apollo),a=(n.redux,n.mui),i=(n.router,n.apolloClient),s={};if(a&&("object"===(void 0===a?"undefined":w(a))?s.currentTheme=a:s.currentTheme=S,r.setTheme=function(e){t.setState({currentTheme:e})}),r.apolloClient)s.apolloClient=r.apolloClient;else if(i)s.apolloClient=i;else if(o){var l={contextPath:r.contextPath};"object"===(void 0===o?"undefined":w(o))&&Object.assign(l,o),s.apolloClient=p.client(l)}return t.state=s,t}return q(c,e),j(c,[{key:"getChildContext",value:function(){return{dxContext:this.props.dxContext}}},{key:"render",value:function(){var e=this.props,t=e.dxContext,n=e.children,r=e.i18n,o=(e.apollo,e.redux),a=(e.mui,e.router),i=this.state,s=i.currentTheme,l=i.apolloClient,c=k.Children.only(n);if(r){var u={currentLanguage:t.uilang,contextPath:t.contextPath};"object"===(void 0===r?"undefined":w(r))&&Object.assign(u,r),c=k.createElement(g.I18nextProvider,{i18n:C(u)},c)}if(a){var p=v.HashRouter,h={};"object"===(void 0===p?"undefined":w(p))&&"outlet"===p.type&&(p=L,h.outlet=p.outlet),c=k.createElement(v.HashRouter,h,c)}if(l&&(c=k.createElement(b.ApolloProvider,{client:l},c)),o&&(c=k.createElement(x.Provider,{store:E},c)),s){var d=t.generateClassName?t.generateClassName:m.createGenerateClassName(),f=t.sheetRegistry?t.sheetRegistry:new P.SheetsRegistry;c=k.createElement(P.JssProvider,{registry:f,generateClassName:d},k.createElement(y.MuiThemeProvider,{theme:s,sheetsManager:new Map},c)),c=k.createElement(F,{notificationContext:{}},c)}return c}}]),c}(k.Component);function D(){return function(n){var e=function(e){function t(){return _(this,t),B(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return q(t,e),j(t,[{key:"render",value:function(){return k.createElement(n,I({dxContext:this.context.dxContext},this.props))}}]),t}(k.Component);return e.contextTypes={dxContext:l.object},e}}V.childContextTypes={dxContext:l.object},e.LanguageSwitcher=function(e){function r(e,t){_(this,r);var n=B(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e,t));return n.state={anchorEl:null},n}return q(r,e),j(r,[{key:"handleClick",value:function(e){this.setState({anchorEl:e.target})}},{key:"handleClose",value:function(e){this.setState({anchorEl:null}),e&&this.context.i18n.changeLanguage(e)}},{key:"render",value:function(){var t=this;return k.createElement("div",null,k.createElement(y.Button,{onClick:this.handleClick.bind(this)},this.props.t("label.languages")),k.createElement(y.Menu,{open:Boolean(this.state.anchorEl),onClose:this.handleClose.bind(this,null),anchorEl:this.state.anchorEl},["fr","en"].map(function(e){return k.createElement(y.MenuItem,{onClick:t.handleClose.bind(t,e),key:e,value:e},e)})))}}]),r}(k.Component),e.LanguageSwitcher.contextTypes={i18n:l.object},e.LanguageSwitcher=g.translate("react-dxcomponents")(e.LanguageSwitcher);e.SettingsLayout=function(e){function t(e){return _(this,t),B(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return q(t,e),j(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.appBar,r=e.children,o=e.footer,a=e.appBarStyle;return k.createElement("section",{className:t.root},k.createElement(y.AppBar,{position:"fixed",classes:{root:t.appBar},style:a},n),k.createElement("section",{className:t.main},r),k.createElement("footer",{className:t.footer},o))}}]),t}(k.Component),e.SettingsLayout.propTypes={appBar:l.element,footer:l.string},e.SettingsLayout=y.withStyles(function(e){return{root:{backgroundColor:e.palette.background.global},main:{minHeight:"calc(100% - 96px)",marginTop:64,padding:1},footer:{fontSize:"14px",fontFamily:e.typography.fontFamily,fontWeight:300,padding:"8px",textAlign:"center",color:e.palette.text.secondary},appBar:{transition:"all 200ms ease-in-out"}}})(e.SettingsLayout);e.SearchBar=function(e){function n(e){_(this,n);var t=B(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.handleChange=t.handleChange.bind(t),t.onFocus=t.onFocus.bind(t),t.onBlur=t.onBlur.bind(t),t.state={focus:!1},t}return q(n,e),j(n,[{key:"handleChange",value:function(e){e.persist(),this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(function(){this.props.onChangeFilter(e.target.value)}.bind(this),1e3)}},{key:"onFocus",value:function(){this.setState({focus:!0}),this.props.onFocus()}},{key:"onBlur",value:function(){this.setState({focus:!1}),this.props.onBlur()}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.t,r=e.placeholderLabel;return k.createElement(y.Input,{classes:{root:this.state.focus?t.rootFocus:t.root,input:t.input},onChange:this.handleChange,onBlur:this.onBlur,onFocus:this.onFocus,disableUnderline:!0,type:"text",placeholder:r||n("label.searchPlaceholder"),startAdornment:k.createElement(y.InputAdornment,{classes:{root:t.searchIcon},position:"start"},k.createElement(c.Search,null)),style:this.props.style})}}]),n}(k.Component),e.SearchBar=y.withStyles(function(e){return{root:{margin:"0",color:"inherit",backgroundColor:e.palette.primary.light,width:"720px",height:"44px",lineHeight:"40px",borderRadius:"3px",fontWeight:"200"},rootFocus:{margin:"0",color:e.palette.text.secondary,backgroundColor:"#fff",width:"720px",height:"44px",lineHeight:"40px",borderRadius:"3px",fontWeight:"100",boxShadow:"0 1px 8px 0 rgba(0, 0, 0, 0.4)"},input:{transitionProperty:"width",transitionDuration:"300ms",transitionTimingFunction:"cubic-bezier(0.4, 0, 0.2, 1)",transitionDelay:"0ms"},searchIcon:{marginTop:"auto",marginBottom:"auto",paddingLeft:"14px",opacity:"0.87"}}})(g.translate("react-dxcomponents")(e.SearchBar));var H=R(["\n            query NodeQuery($path:String!, $workspace:Workspace!) {\n                jcr(workspace:$workspace) {\n                    workspace\n                    node:nodeByPath(path: $path) {\n                        workspace\n                        path\n                        uuid\n                        ... node\n                    }\n                }\n            }"],["\n            query NodeQuery($path:String!, $workspace:Workspace!) {\n                jcr(workspace:$workspace) {\n                    workspace\n                    node:nodeByPath(path: $path) {\n                        workspace\n                        path\n                        uuid\n                        ... node\n                    }\n                }\n            }"]);var A=R(["\n            query NodesQuery($path:String!, $types:[String]!) {\n                jcr {\n                    node:nodeByPath(path: $path) {\n                        path\n                        uuid\n                        name\n                        children(typesFilter:{types:$types}) {\n                            nodes {\n                                path\n                                uuid\n                                name\n                                ... node\n                            }\n                        }\n                    }\n                }\n            }"],["\n            query NodesQuery($path:String!, $types:[String]!) {\n                jcr {\n                    node:nodeByPath(path: $path) {\n                        path\n                        uuid\n                        name\n                        children(typesFilter:{types:$types}) {\n                            nodes {\n                                path\n                                uuid\n                                name\n                                ... node\n                            }\n                        }\n                    }\n                }\n            }"]);e.PickerViewMaterial=function(e){var n=this,r=e.theme,o=e.classes,t=e.pickerEntries,a=e.onOpenItem,i=e.onSelectItem,s=e.textRenderer,l=e.iconRenderer;return k.createElement(y.List,{classes:{root:o.root,padding:o.padding}},t.map(function(t){return k.createElement(y.ListItem,{button:!0,onClick:function(){return t.selectable?i(t.path,!t.selected):a(t.path,!t.open)},key:t.path,divider:!0,classes:t.selected?{root:o.selected}:{}},k.createElement(y.ListItemIcon,{classes:t.selected?{root:o.selectedText}:{}},t.openable&&t.hasChildren?k.createElement(y.IconButton,{onClick:function(e){a(t.path,!t.open),e.stopPropagation()}},t.open?k.createElement(c.ExpandLess,null):k.createElement(c.ExpandMore,null)):k.createElement(c.ExpandMore,{style:{opacity:0}})),k.createElement(y.ListItemIcon,{classes:t.selected?{root:o.selectedText}:{},style:{paddingLeft:t.depth*r.spacing.unit}},l&&l.call(n,t)),k.createElement(y.ListItemText,{classes:t.selected?{primary:o.selectedText}:{},inset:!0,primary:s?s.call(n,t):t.name}))}))},e.PickerViewMaterial.propTypes={pickerEntries:l.array.isRequired,onSelectItem:l.func,onOpenItem:l.func,textRenderer:l.func},e.PickerViewMaterial=y.withTheme()(y.withStyles(function(e){return{root:{},padding:{paddingTop:0,paddingBottom:0},selected:{backgroundColor:e.palette.secondary.light,"&:hover":{backgroundColor:d.fade(e.palette.secondary.light,.7)}},selectedText:{color:e.palette.secondary.contrastText}}})(e.PickerViewMaterial)),e.PickerViewMaterialMultiple=function(t){var n=this;return k.createElement(y.List,null,t.pickerEntries.map(function(e){return k.createElement(y.ListItem,{button:!0,onClick:function(){return e.selectable?t.onSelectItem(e.path,!e.selected,!0):t.onOpenItem(e.path,!e.open)},key:e.path},k.createElement(y.ListItemIcon,{style:e.selectable?{}:{opacity:0}},e.selected?k.createElement(c.CheckBox,null):k.createElement(c.CheckBoxOutlineBlank,null)),k.createElement(y.ListItemText,{style:{paddingLeft:e.depth*t.theme.spacing.unit},inset:!0,primary:t.textRenderer?t.textRenderer.call(n,e):e.name}),k.createElement(y.ListItemSecondaryAction,null,e.openable&&e.hasChildren?k.createElement(y.IconButton,{onClick:function(){return t.onOpenItem(e.path,!e.open)}},e.open?k.createElement(c.ExpandLess,null):k.createElement(c.ExpandMore,null)):null))}))},e.PickerViewMaterialMultiple.propTypes={pickerEntries:l.array.isRequired,onSelectItem:l.func,onOpenItem:l.func,textRenderer:l.func},e.PickerViewMaterialMultiple=y.withTheme()(e.PickerViewMaterialMultiple);var W=R(["\n            query PickerQuery($rootPaths:[String!]!, $selectable:[String]!, $openable:[String]!, $openPaths:[String!]!, $types:[String]!) {\n                jcr {\n                    rootNodes:nodesByPath(paths: $rootPaths) {\n                        path\n                        uuid\n                        name\n                        children(typesFilter:{types:$types}, limit:1) {\n                            pageInfo {\n                                totalCount\n                            }\n                        }\n                        selectable : isNodeType(type: {types:$selectable})\n                        openable : isNodeType(type: {types:$openable})\n                        ... node\n                    },\n                    openNodes:nodesByPath(paths: $openPaths) {\n                        path\n                        uuid\n                        children(typesFilter:{types:$types}) {\n                            nodes {\n                                path\n                                uuid\n                                name\n                                children(typesFilter:{types:$types}, limit:1) {\n                                    pageInfo {\n                                        totalCount\n                                    }\n                                }\n                                selectable : isNodeType(type: {types:$selectable})\n                                openable : isNodeType(type: {types:$openable})\n                                ... node\n                            }\n                        }\n                    }\n                }\n            }"],["\n            query PickerQuery($rootPaths:[String!]!, $selectable:[String]!, $openable:[String]!, $openPaths:[String!]!, $types:[String]!) {\n                jcr {\n                    rootNodes:nodesByPath(paths: $rootPaths) {\n                        path\n                        uuid\n                        name\n                        children(typesFilter:{types:$types}, limit:1) {\n                            pageInfo {\n                                totalCount\n                            }\n                        }\n                        selectable : isNodeType(type: {types:$selectable})\n                        openable : isNodeType(type: {types:$openable})\n                        ... node\n                    },\n                    openNodes:nodesByPath(paths: $openPaths) {\n                        path\n                        uuid\n                        children(typesFilter:{types:$types}) {\n                            nodes {\n                                path\n                                uuid\n                                name\n                                children(typesFilter:{types:$types}, limit:1) {\n                                    pageInfo {\n                                        totalCount\n                                    }\n                                }\n                                selectable : isNodeType(type: {types:$selectable})\n                                openable : isNodeType(type: {types:$openable})\n                                ... node\n                            }\n                        }\n                    }\n                }\n            }"]),Q=function(e){function s(e){_(this,s);var t=B(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,e)),n=h(W),r=e.fragments,o=$(e,["fragments"]);p.replaceFragmentsInDocument(n,r),t.graphqlComponentProps=o;var a={},i=t;return e.openPaths||(a.openPaths=e.defaultOpenPaths?u.clone(e.defaultOpenPaths):[],o.onOpenItem=function(n,r){i.setState(function(e,t){return{openPaths:r?[].concat(N(e.openPaths),[n]):u.filter(e.openPaths,function(e){return e!==n})}}),e.onOpenItem&&e.onOpenItem(n,r)}),e.selectedPaths||(a.selectedPaths=e.defaultSelectedPaths?u.clone(e.defaultSelectedPaths):[],o.onSelectItem=function(n,r,o){i.setState(function(e,t){return{selectedPaths:r?[].concat(N(o?e.selectedPaths:[]),[n]):u.filter(e.selectedPaths,function(e){return e!==n})}}),e.onSelectItem&&e.onSelectItem(n,select,o)}),t.state=a,t.GraphQLComponent=b.graphql(n,{props:t.mapResultsToProps,options:t.mapPropsToOptions})(t.props.render),t}return q(s,e),j(s,[{key:"componentDidUpdate",value:function(e,t,n){this.props.onSelectionChange&&!u.isEqual(this.state.selectedPaths,t.selectedPaths)&&this.props.onSelectionChange(this.state.selectedPaths)}},{key:"componentWillReceiveProps",value:function(e,t){e.fragments,e.onOpenItem,e.onSelectItem;var n=$(e,["fragments","onOpenItem","onSelectItem"]);u.assign(this.graphqlComponentProps,n)}},{key:"mapResultsToProps",value:function(e){var t=e.data,n=e.ownProps,a=n.selectedPaths,i=n.openPaths?n.openPaths:[],s=[],l={},r=t.jcr,o=function(e,t,n){var r=!1;e.selectable&&(r=-1!==u.indexOf(a,e.path));var o={name:e.name,path:e.path,open:e.openable&&-1!==u.indexOf(i,e.path),selected:r,openable:e.openable,selectable:e.selectable,depth:t,prefix:u.repeat("&nbsp;",3*t),node:e,hidden:!1,hasChildren:0<e.children.pageInfo.totalCount};return s.splice(n,0,o),l[e.uuid]=o};r&&(r.rootNodes&&u.forEach(r.rootNodes,function(e){o(e,0,0).hidden=n.hideRoot}),r.openNodes&&u.sortBy(r.openNodes,["path"]).forEach(function(e){var t=l[e.uuid];if(t){var n=u.indexOf(s,t);u.forEachRight(e.children.nodes,function(e){o(e,t.depth+1,n+1)})}}));var c=u.filter(s,function(e){return e.selected}).map(function(e){return e.node});return a=u.map(c,"path"),s=u.filter(s,function(e){return!e.hidden}),I({},n,{pickerEntries:s})}},{key:"mapPropsToOptions",value:function(o){var a=o.openPaths?o.openPaths:[];o.selectedPaths&&u.each(o.selectedPaths,function(e){return n=o,t=e,r=!1,void u.tail(u.split(t,"/")).reduce(function(t,e){return r||u.forEach(n.rootPaths,function(e){r=r||u.startsWith(t,e)}),r&&-1===u.indexOf(a,t)&&a.push(t),t+"/"+e},"");var n,t,r});var e={rootPaths:o.rootPaths,types:u.union(o.openableTypes,o.selectableTypes),selectable:o.selectableTypes,openable:o.openableTypes,openPaths:a};return o.queryVariables&&u.assign(e,o.queryVariables),{variables:e}}},{key:"render",value:function(){var e=this.GraphQLComponent;return k.createElement(e,I({},this.graphqlComponentProps,this.state))}}]),s}(k.Component);Q.propTypes={rootPaths:l.arrayOf(l.string).isRequired,defaultOpenPaths:l.arrayOf(l.string),openableTypes:l.arrayOf(l.string).isRequired,openPaths:l.arrayOf(l.string),selectableTypes:l.arrayOf(l.string).isRequired,defaultSelectedPaths:l.arrayOf(l.string),selectedPaths:l.arrayOf(l.string),onSelectionChange:l.func,render:l.func,fragments:l.arrayOf(l.oneOfType([l.string,l.shape({applyFor:l.string.isRequired,variables:l.string,gql:l.object.isRequired})])),queryVariables:l.object},e.DxContextProvider=V,e.withDxContext=D,e.getI18n=C,e.withNodeFromPath=function(n){return function(e){var t=h(H);return p.replaceFragmentsInDocument(t,n),b.graphql(t,{props:function(e){var t=e.data,n=e.ownProps,r=void 0;return t.jcr&&t.jcr.node&&(r=t.jcr.node),I({},n,{node:r})},options:function(e){var t={path:e.path,workspace:e.workspace?e.workspace:"EDIT"};return e.queryVariables&&u.assign(t,e.queryVariables),{variables:t,skip:!e.path}}})(e)}},e.withNodesFromPath=function(n){return function(e){var t=h(A);return p.replaceFragmentsInDocument(t,n),b.graphql(t,{props:function(e){var t=e.data,n=e.ownProps,r=[],o=t.jcr;return o&&o.node&&(r=o.node.children.nodes),I({},n,{nodes:r})},options:function(e){var t={path:e.path,types:e.types};return e.queryVariables&&u.assign(t,e.queryVariables),{variables:t,skip:!e.path}}})(e)}},e.withPathFromSelection=function(n){return function(e){return x.connect(function(e,t){return I({},t,{path:e["selectedPaths_"+n]&&1===e["selectedPaths_"+n].length?e["selectedPaths_"+n][0]:null})},function(){return{}})(e)}},e.NotificationProvider=F,e.withNotifications=function(){return function(n){var e=function(e){function t(){return _(this,t),B(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return q(t,e),j(t,[{key:"render",value:function(){return k.createElement(n,I({notificationContext:this.context.notificationContext},this.props))}}]),t}(k.Component);return e.contextTypes={notificationContext:l.object},e}},e.Picker=Q,e.createOutletHistory=M,e.OutletRouter=L,e.reducers=O,e.store=E,e.resetStateReducer=function(e,t){if("RESET_STATE"!==t.type)return e},e.theme=S,e.darkTheme=T,Object.defineProperty(e,"__esModule",{value:!0})});