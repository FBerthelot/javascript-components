!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("material-ui"),require("i18next"),require("i18next-xhr-backend"),require("react-i18next"),require("redux"),require("lodash"),require("material-ui/colors/index"),require("@jahia/apollo-dx"),require("react-apollo"),require("react-redux"),require("react-router-dom"),require("history"),require("react-router"),require("prop-types"),require("react-dom"),require("graphql-tag"),require("material-ui-icons")):"function"==typeof define&&define.amd?define(["exports","react","material-ui","i18next","i18next-xhr-backend","react-i18next","redux","lodash","material-ui/colors/index","@jahia/apollo-dx","react-apollo","react-redux","react-router-dom","history","react-router","prop-types","react-dom","graphql-tag","material-ui-icons"],t):t((e.jahia=e.jahia||{},e.jahia.reactcomponents={}),e.React,e.materialUi,e.i18n,e.XHR,e.reactI18next,e.redux,e._,e.index,e.jahia.apollodx,e.reactApollo,e.reactRedux,e.reactRouterDom,e.history,e.reactRouter,e.PropTypes,e.ReactDOM,e.gql,e.materialUiIcons)}(this,function(e,t,m,n,r,f,a,y,o,g,v,b,P,i,l,u,s,c,p){"use strict";var E="default"in t?t.default:t;function O(e){return e=e||{},n.use(r).init({lng:e.currentLanguage?e.currentLanguage:void 0,fallbackLng:"en",debug:!0,interpolation:{escapeValue:!1},react:{wait:!1,bindI18n:"languageChanged loaded",bindStore:"added removed",nsMode:"default"},backend:{loadPath:(e.contextPath?e.contextPath:"")+"/modules/{{ns}}/javascript/locales/{{lng}}.json"}}),n}n=n&&n.hasOwnProperty("default")?n.default:n,r=r&&r.hasOwnProperty("default")?r.default:r,u=u&&u.hasOwnProperty("default")?u.default:u,s=s&&s.hasOwnProperty("default")?s.default:s,c=c&&c.hasOwnProperty("default")?c.default:c;var d,h={},x=(d=void 0,"undefined"!=typeof window&&(d=window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__({name:"DX Redux",instanceId:"dx"})),a.createStore(function(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=arguments[1];return y.mapValues(h,function(e,t){return e(n[t],r)})},d)),C=m.createMuiTheme({palette:{contrastThreshold:3.1,tonalOffset:.07,primary:{light:o.indigo[300],main:o.indigo[500],dark:o.indigo[700]},secondary:{light:o.pink[200],main:o.pink[400],dark:o.pink[700]},error:{light:o.red.A200,main:o.red.A400,dark:o.red.A700}}});function T(a,o){var r=this,n=function(e){var t=[],n=a.location.pathname,r=o+":"+e;return-1<n.indexOf("(")&&(t=(n=(n=n.substr(n.indexOf("(")+1)).substr(0,n.indexOf(")"))).split("//"),t=y.map(t,function(e){return e.startsWith(o+":")?r:e})),-1===t.indexOf(r)&&t.push(r),"/("+y.join(t,"//")+")"},i=function(e){var t=void 0;return e?(t=a.location.state?a.location.state:{})["router_"+o]=e:a.location.state&&delete(t=a.location.state)["router_"+o],t},l=function(e){if(-1<e.indexOf("(")){var t=(e=(e=e.substr(e.indexOf("(")+1)).substr(0,e.indexOf(")"))).split("//"),n=o+":",r=y.find(t,function(e){return e.startsWith(n)});if(r)return r.substr(n.length)}return""},e=y.clone(a.location);e.pathname=l(e.pathname);var u=[],s={length:a.length,action:a.action,location:e,createHref:function(e){return a.createHref({pathname:n(e.pathname)})},push:function(e,t){return a.push(n(e),i(t))},replace:function(e,t){a.replace(n(e),i(t))},go:function(e){a.go(e)},goBack:function(){a.goBack()},goForward:function(){a.goForward()},block:function(e){return a.block(e)},listen:function(e){return u.push(e),function(){y.pull(u,e)}},dispose:function(){t()}},t=a.listen(function(e){var t=l(e.pathname),n=void 0;e.state&&e.state["router_"+o]&&(n=e.state["router_"+o]),s.location.pathname===t&&s.location.state===n||(Object.assign(s.location,e),s.location.pathname=t,s.location.state=n,y.each(u,function(e){return e.call(r,s.location)}))});return s}var k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},w=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},j=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},$=function(e,t){var n={};for(var r in e)0<=t.indexOf(r)||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n},q=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},I=function(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))},N=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},R=i.createHashHistory(),L=function(e){function n(e){S(this,n);var t=q(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.outletHistory=T(R,e.outlet),t}return j(n,e),w(n,[{key:"componentWillMount",value:function(){}},{key:"componentWillUnmount",value:function(){this.outletHistory.dispose()}},{key:"render",value:function(){return E.createElement(l.Router,{history:this.outletHistory},this.props.children)}}]),n}(E.Component),M=function(e){function t(e){return S(this,t),q(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return j(t,e),w(t,[{key:"render",value:function(){return E.createElement(L,{outlet:this.props.id},E.createElement("div",null,E.createElement(P.Link,{to:"/test1/value1"},"test1/value1"),E.createElement(P.Link,{to:"/test1/value2"},"Test1/value2"),E.createElement(P.Link,{to:"/test2"},"test2"),E.createElement(P.Link,{to:"/test3"},"test3"),E.createElement(P.Route,{path:"/test1/:value",component:function(e){return E.createElement(m.Paper,{elevation:4},E.createElement(m.Typography,{type:"headline",component:"h3"},"Page 1"),E.createElement(m.Typography,{component:"p"},"Param = ",e.match.params.value))}}),E.createElement(P.Route,{path:"/test2",component:function(e){return E.createElement(m.Paper,{elevation:4},E.createElement(m.Typography,{type:"headline",component:"h3"},"Page 2"))}}),E.createElement(P.Route,{path:"/test3",component:function(e){return E.createElement(m.Paper,{elevation:4},E.createElement(m.Typography,{type:"headline",component:"h3"},"Page 3"))}})))}}]),t}(E.Component),B=function(e){function t(e){return S(this,t),q(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return j(t,e),w(t,[{key:"getChildContext",value:function(){return{dxContext:this.props.dxContext}}},{key:"render",value:function(){var e=this.props,t=e.dxContext,n=e.children,r=e.i18n,a=e.apollo,o=e.redux,i=e.mui,l=e.router,u=E.Children.only(n);if(r){var s={currentLanguage:t.uilang,contextPath:t.contextPath};"object"===(void 0===r?"undefined":k(r))&&Object.assign(s,r),u=E.createElement(f.I18nextProvider,{i18n:O(s)},u)}if(l){var c=P.HashRouter,p={};"object"===(void 0===c?"undefined":k(c))&&"outlet"===c.type&&(c=L,p.outlet=c.outlet),u=E.createElement(P.HashRouter,p,u)}if(a){var d={contextPath:t.contextPath};"object"===(void 0===a?"undefined":k(a))&&Object.assign(d,a),u=E.createElement(v.ApolloProvider,{client:g.client(d)},u)}if(o&&(u=E.createElement(b.Provider,{store:x},u)),i){var h=C;"object"===(void 0===i?"undefined":k(i))&&(h=y.merge({},C,i)),u=E.createElement(m.MuiThemeProvider,{theme:h},u)}return u}}]),t}(E.Component);B.childContextTypes={dxContext:u.object};var V=function(e){function n(e){S(this,n);var t=q(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.state={reactElements:[]},t}return j(n,e),w(n,[{key:"componentDidMount",value:function(){var t=this;this.props.components&&!this.done&&this.props.components.then(function(e){t.done=!0,t.setState({reactElements:e})})}},{key:"componentDidUpdate",value:function(){this.componentDidMount()}},{key:"render",value:function(){return this.done?E.createElement("div",null,this.state.reactElements):E.createElement("div",null)}}]),n}(E.Component),D=I(['\n                query ComponentsQuery($query:String!) {\n                    jcr {\n                        nodesByQuery(query:$query) {\n                            nodes {\n                                name\n                                path\n                                primaryNodeType {\n                                    name\n                                }\n                                children {\n                                    nodes {\n                                        name\n                                        path\n                                        primaryNodeType {\n                                            name\n                                        }\n                                        renderedView(templateType:"js", view:"react") {\n                                            output\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }'],['\n                query ComponentsQuery($query:String!) {\n                    jcr {\n                        nodesByQuery(query:$query) {\n                            nodes {\n                                name\n                                path\n                                primaryNodeType {\n                                    name\n                                }\n                                children {\n                                    nodes {\n                                        name\n                                        path\n                                        primaryNodeType {\n                                            name\n                                        }\n                                        renderedView(templateType:"js", view:"react") {\n                                            output\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }']),Q=function(e){function n(e){S(this,n);var t=q(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.componentCache=[],t}return j(n,e),w(n,[{key:"mapResultsToProps",value:function(e){var t=e.data,n=e.ownProps,a=[],r=t.jcr,o=eval;r&&r.nodesByQuery&&(a=y.map(y.flatMap(r.nodesByQuery.nodes,"children.nodes"),function(e){return o("("+e.renderedView.output+")")}));var i=[];y.each(a,function(e){i=i.concat(e.getImports())});var l=void 0;return 0<i.length&&(l=Promise.all(y.map(i,function(e){return SystemJS.import(e)})).then(function(r){return y.map(a,function(e){var t=e.getImports().length,n=e.createElement.apply(e,[E,s].concat(N(r)));return r.splice(t),n})})),_({},n,{components:l})}},{key:"mapPropsToOptions",value:function(e){return{variables:{query:"select * from [reactnt:componentsFolder] where [react:id]='"+e.id+"'"}}}},{key:"render",value:function(){var t=this.props.renderComponent,e=y.find(this.componentCache,function(e){return e.renderComponent===t}),n=void 0;if(e)n=e.dataComponent;else{var r=c(D);n=v.graphql(r,{props:this.mapResultsToProps,options:this.mapPropsToOptions})(t||V),this.componentCache.push({renderComponent:t,dataComponent:n})}return E.createElement(n,this.props)}}]),n}(E.Component);Q.propTypes={id:u.string.isRequired,renderComponent:u.element},e.LanguageSwitcher=function(e){function r(e,t){S(this,r);var n=q(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e,t));return n.state={anchorEl:null},n}return j(r,e),w(r,[{key:"handleClick",value:function(e){this.setState({anchorEl:e.target})}},{key:"handleClose",value:function(e){this.setState({anchorEl:null}),e&&this.context.i18n.changeLanguage(e)}},{key:"render",value:function(){var t=this;return E.createElement("div",null,E.createElement(m.Button,{onClick:this.handleClick.bind(this)},this.props.t("label.languages")),E.createElement(m.Menu,{open:Boolean(this.state.anchorEl),onClose:this.handleClose.bind(this,null),anchorEl:this.state.anchorEl},["fr","en"].map(function(e){return E.createElement(m.MenuItem,{onClick:t.handleClose.bind(t,e),key:e,value:e},e)})))}}]),r}(E.Component),e.LanguageSwitcher.contextTypes={i18n:u.object},e.LanguageSwitcher=f.translate("react-dxcomponents")(e.LanguageSwitcher);var F=function(e){return E.createElement(m.Grid,{container:!0},E.createElement(m.Grid,{item:!0,xs:12,md:6},E.createElement(m.Paper,null," ",e.leftCol)),E.createElement(m.Grid,{item:!0,xs:12,md:6},E.createElement(m.Paper,null,e.rightCol)))};F.propTypes={leftCol:u.element,rightCol:u.element};var H=I(["\n            query NodesQuery($path:String!, $types:[String]!) {\n                jcr {\n                    node:nodeByPath(path: $path) {\n                        path\n                        uuid\n                        name\n                        children(typesFilter:{types:$types}) {\n                            nodes {\n                                path\n                                uuid\n                                name\n                                ... node\n                            }\n                        }\n                    }\n                }\n            }"],["\n            query NodesQuery($path:String!, $types:[String]!) {\n                jcr {\n                    node:nodeByPath(path: $path) {\n                        path\n                        uuid\n                        name\n                        children(typesFilter:{types:$types}) {\n                            nodes {\n                                path\n                                uuid\n                                name\n                                ... node\n                            }\n                        }\n                    }\n                }\n            }"]);function A(n){return function(e){var t=c(H);return g.replaceFragmentsInDocument(t,n),v.graphql(t,{props:function(e){var t=e.data,n=e.ownProps,r=[],a=t.jcr;return a&&a.node&&(r=a.node.children.nodes),_({},n,{nodes:r})},options:function(e){var t={path:e.path,types:e.types};return e.queryVariables&&y.assign(t,e.queryVariables),{variables:t,skip:!e.path}}})(e)}}var U=I(['fragment Test on JCRNode {\n                myprop:property(name:"myprop") {\n                    value\n                }\n            }'],['fragment Test on JCRNode {\n                myprop:property(name:"myprop") {\n                    value\n                }\n            }']),W=I(['\n    mutation setProperty($value:String,$path:String!) {\n        jcr {\n            mutateNode(pathOrId:$path) {\n                mutateProperty(name:"myprop") {\n                    setValue(value:$value)\n                }\n                node {\n                    path\n                }\n            }\n        }\n    }\n'],['\n    mutation setProperty($value:String,$path:String!) {\n        jcr {\n            mutateNode(pathOrId:$path) {\n                mutateProperty(name:"myprop") {\n                    setValue(value:$value)\n                }\n                node {\n                    path\n                }\n            }\n        }\n    }\n']),X=I(['\n    mutation addNode($value:String, $name:String!) {\n        jcr {\n            addNode(parentPathOrId:"/",name:$name,primaryNodeType:"nt:unstructured") {\n                mutateProperty(name:"myprop") {\n                    setValue(value:$value)\n                }\n            }\n        }\n    }\n'],['\n    mutation addNode($value:String, $name:String!) {\n        jcr {\n            addNode(parentPathOrId:"/",name:$name,primaryNodeType:"nt:unstructured") {\n                mutateProperty(name:"myprop") {\n                    setValue(value:$value)\n                }\n            }\n        }\n    }\n']),G=I(["\n    mutation removeNode($path:String!) {\n        jcr {\n            deleteNode(pathOrId:$path)\n        }\n    }\n"],["\n    mutation removeNode($path:String!) {\n        jcr {\n            deleteNode(pathOrId:$path)\n        }\n    }\n"]),J=function(e){function n(e){S(this,n);var t=q(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.Component=A([{applyFor:"node",gql:c(U)}])(function(e){return E.createElement(m.Table,null,E.createElement(m.TableHead,null,E.createElement(m.TableRow,null,E.createElement(m.TableCell,null,"Name"),E.createElement(m.TableCell,null,"Value"),E.createElement(m.TableCell,null,"Update"),E.createElement(m.TableCell,null,"Delete"))),E.createElement(m.TableBody,null,e.nodes?e.nodes.map(function(e){return E.createElement(m.TableRow,{key:e.uuid},E.createElement(m.TableCell,null,e.name),E.createElement(m.TableCell,null,e.myprop.value),E.createElement(m.TableCell,null,E.createElement(m.Button,{onClick:function(){return t.props.setPropertyMutation({variables:{path:e.path,value:"test:"+new Date},refetchQueries:["NodesQuery"]})}},"Update")),E.createElement(m.TableCell,null,E.createElement(m.Button,{onClick:function(){return t.props.removeNodeMutation({variables:{path:e.path},refetchQueries:["NodesQuery"]})}},"Delete")))}):[]))}),t}return j(n,e),w(n,[{key:"render",value:function(){var e=this,t=this.Component;return E.createElement("div",null,E.createElement(m.Button,{onClick:function(){return e.props.addNodeMutation({variables:{name:"name-"+(new Date).getTime(),value:"test:"+new Date},refetchQueries:["NodesQuery"]})}},"New"),E.createElement(t,{path:"/",types:["nt:unstructured"]}))}}]),n}(t.Component),z=c(W),K=c(X),Y=c(G),Z=v.graphql(z,{name:"setPropertyMutation"})(v.graphql(K,{name:"addNodeMutation"})(v.graphql(Y,{name:"removeNodeMutation"})(J))),ee=function(t){var n=this,e=t.headers?t.headers:function(){return E.createElement(m.TableRow,null,E.createElement(m.TableCell,null,"Name"))},r=t.row?t.row:function(e){return E.createElement(m.TableRow,{key:e.path},E.createElement(m.TableCell,null,t.textRenderer?t.textRenderer.call(n,e):e.name))};return E.createElement(m.Table,null,E.createElement(m.TableHead,null,e()),E.createElement(m.TableBody,null,t.nodes?t.nodes.map(r):[]))};ee.propTypes={headers:u.func,row:u.func,textRenderer:u.func,nodes:u.arrayOf(u.object)},e.PickerViewMaterial=function(t){var n=this;return E.createElement(m.List,null,t.pickerEntries.map(function(e){return E.createElement(m.ListItem,{button:!0,onClick:function(){return e.selectable?t.onSelectItem(e.path,!e.selected):t.onOpenItem(e.path,!e.open)},key:e.path},E.createElement(m.ListItemIcon,{style:e.selectable?{}:{opacity:0}},e.selected?E.createElement(p.RadioButtonChecked,null):E.createElement(p.RadioButtonUnchecked,null)),E.createElement(m.ListItemText,{style:{paddingLeft:e.depth*t.theme.spacing.unit},inset:!0,primary:t.textRenderer?t.textRenderer.call(n,e):e.name}),E.createElement(m.ListItemSecondaryAction,null,e.openable&&e.hasChildren?E.createElement(m.IconButton,{onClick:function(){return t.onOpenItem(e.path,!e.open)}},e.open?E.createElement(p.ExpandLess,null):E.createElement(p.ExpandMore,null)):null))}))},e.PickerViewMaterial.propTypes={pickerEntries:u.array.isRequired,onSelectItem:u.func,onOpenItem:u.func,textRenderer:u.func},e.PickerViewMaterial=m.withTheme()(e.PickerViewMaterial),e.PickerViewMaterialMultiple=function(t){var n=this;return E.createElement(m.List,null,t.pickerEntries.map(function(e){return E.createElement(m.ListItem,{button:!0,onClick:function(){return e.selectable?t.onSelectItem(e.path,!e.selected,!0):t.onOpenItem(e.path,!e.open)},key:e.path},E.createElement(m.ListItemIcon,{style:e.selectable?{}:{opacity:0}},e.selected?E.createElement(p.CheckBox,null):E.createElement(p.CheckBoxOutlineBlank,null)),E.createElement(m.ListItemText,{style:{paddingLeft:e.depth*t.theme.spacing.unit},inset:!0,primary:t.textRenderer?t.textRenderer.call(n,e):e.name}),E.createElement(m.ListItemSecondaryAction,null,e.openable&&e.hasChildren?E.createElement(m.IconButton,{onClick:function(){return t.onOpenItem(e.path,!e.open)}},e.open?E.createElement(p.ExpandLess,null):E.createElement(p.ExpandMore,null)):null))}))},e.PickerViewMaterialMultiple.propTypes={pickerEntries:u.array.isRequired,onSelectItem:u.func,onOpenItem:u.func,textRenderer:u.func},e.PickerViewMaterialMultiple=m.withTheme()(e.PickerViewMaterialMultiple);var te=I(["\n            query PickerQuery($rootPaths:[String!]!, $selectable:[String]!, $openable:[String]!, $openPaths:[String!]!, $types:[String]!) {\n                jcr {\n                    rootNodes:nodesByPath(paths: $rootPaths) {\n                        path\n                        uuid\n                        name\n                        children(typesFilter:{types:$types}, limit:1) {\n                            pageInfo {\n                                totalCount\n                            }\n                        }\n                        selectable : isNodeType(type: {types:$selectable})\n                        openable : isNodeType(type: {types:$openable})\n                        ... node\n                    },\n                    openNodes:nodesByPath(paths: $openPaths) {\n                        path\n                        uuid\n                        children(typesFilter:{types:$types}) {\n                            nodes {\n                                path\n                                uuid\n                                name\n                                children(typesFilter:{types:$types}, limit:1) {\n                                    pageInfo {\n                                        totalCount\n                                    }\n                                }\n                                selectable : isNodeType(type: {types:$selectable})\n                                openable : isNodeType(type: {types:$openable})\n                                ... node\n                            }\n                        }\n                    }\n                }\n            }"],["\n            query PickerQuery($rootPaths:[String!]!, $selectable:[String]!, $openable:[String]!, $openPaths:[String!]!, $types:[String]!) {\n                jcr {\n                    rootNodes:nodesByPath(paths: $rootPaths) {\n                        path\n                        uuid\n                        name\n                        children(typesFilter:{types:$types}, limit:1) {\n                            pageInfo {\n                                totalCount\n                            }\n                        }\n                        selectable : isNodeType(type: {types:$selectable})\n                        openable : isNodeType(type: {types:$openable})\n                        ... node\n                    },\n                    openNodes:nodesByPath(paths: $openPaths) {\n                        path\n                        uuid\n                        children(typesFilter:{types:$types}) {\n                            nodes {\n                                path\n                                uuid\n                                name\n                                children(typesFilter:{types:$types}, limit:1) {\n                                    pageInfo {\n                                        totalCount\n                                    }\n                                }\n                                selectable : isNodeType(type: {types:$selectable})\n                                openable : isNodeType(type: {types:$openable})\n                                ... node\n                            }\n                        }\n                    }\n                }\n            }"]),ne=function(e){function l(e){S(this,l);var t=q(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,e)),n=c(te),r=e.fragments,a=$(e,["fragments"]);g.replaceFragmentsInDocument(n,r),t.graphqlComponentProps=a;var o={},i=t;return e.openPaths||(o.openPaths=e.defaultOpenPaths?y.clone(e.defaultOpenPaths):[],a.onOpenItem=function(n,r){i.setState(function(e,t){return{openPaths:r?[].concat(N(e.openPaths),[n]):y.filter(e.openPaths,function(e){return e!==n})}}),e.onOpenItem&&e.onOpenItem(n,r)}),e.selectedPaths||(o.selectedPaths=e.defaultSelectedPaths?y.clone(e.defaultSelectedPaths):[],a.onSelectItem=function(n,r,a){i.setState(function(e,t){return{selectedPaths:r?[].concat(N(a?e.selectedPaths:[]),[n]):y.filter(e.selectedPaths,function(e){return e!==n})}}),e.onSelectItem&&e.onSelectItem(n,select,a)}),t.state=o,t.GraphQLComponent=v.graphql(n,{props:t.mapResultsToProps,options:t.mapPropsToOptions})(t.props.render),t}return j(l,e),w(l,[{key:"componentDidUpdate",value:function(e,t,n){this.props.onSelectionChange&&!y.isEqual(this.state.selectedPaths,t.selectedPaths)&&this.props.onSelectionChange(this.state.selectedPaths)}},{key:"componentWillReceiveProps",value:function(e,t){e.fragments,e.onOpenItem,e.onSelectItem;var n=$(e,["fragments","onOpenItem","onSelectItem"]);y.assign(this.graphqlComponentProps,n)}},{key:"mapResultsToProps",value:function(e){var t=e.data,n=e.ownProps,o=n.selectedPaths,i=n.openPaths?n.openPaths:[],l=[],u={},r=t.jcr,a=function(e,t,n){var r=!1;e.selectable&&(r=-1!==y.indexOf(o,e.path));var a={name:e.name,path:e.path,open:e.openable&&-1!==y.indexOf(i,e.path),selected:r,openable:e.openable,selectable:e.selectable,depth:t,prefix:y.repeat("&nbsp;",3*t),node:e,hidden:!1,hasChildren:0<e.children.pageInfo.totalCount};return l.splice(n,0,a),u[e.uuid]=a};r&&(r.rootNodes&&y.forEach(r.rootNodes,function(e){a(e,0,0).hidden=n.hideRoot}),r.openNodes&&y.sortBy(r.openNodes,["path"]).forEach(function(e){var t=u[e.uuid];if(t){var n=y.indexOf(l,t);y.forEachRight(e.children.nodes,function(e){a(e,t.depth+1,n+1)})}}));var s=y.filter(l,function(e){return e.selected}).map(function(e){return e.node});return o=y.map(s,"path"),l=y.filter(l,function(e){return!e.hidden}),_({},n,{pickerEntries:l})}},{key:"mapPropsToOptions",value:function(a){var o=a.openPaths?a.openPaths:[];a.selectedPaths&&y.each(a.selectedPaths,function(e){return n=a,t=e,r=!1,void y.tail(y.split(t,"/")).reduce(function(t,e){return r||y.forEach(n.rootPaths,function(e){r=r||y.startsWith(t,e)}),r&&-1===y.indexOf(o,t)&&o.push(t),t+"/"+e},"");var n,t,r});var e={rootPaths:a.rootPaths,types:y.union(a.openableTypes,a.selectableTypes),selectable:a.selectableTypes,openable:a.openableTypes,openPaths:o};return a.queryVariables&&y.assign(e,a.queryVariables),{variables:e}}},{key:"render",value:function(){var e=this.GraphQLComponent;return E.createElement(e,_({},this.graphqlComponentProps,this.state))}}]),l}(E.Component);ne.propTypes={rootPaths:u.arrayOf(u.string).isRequired,defaultOpenPaths:u.arrayOf(u.string),openableTypes:u.arrayOf(u.string).isRequired,openPaths:u.arrayOf(u.string),selectableTypes:u.arrayOf(u.string).isRequired,defaultSelectedPaths:u.arrayOf(u.string),selectedPaths:u.arrayOf(u.string),onSelectionChange:u.func,render:u.func,fragments:u.arrayOf(u.oneOfType([u.string,u.shape({applyFor:u.string.isRequired,variables:u.string,gql:u.object.isRequired})])),queryVariables:u.object},e.DxContextProvider=B,e.withDxContext=function(){return function(n){var e=function(e){function t(){return S(this,t),q(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return j(t,e),w(t,[{key:"render",value:function(){return E.createElement(n,_({dxContext:this.context.dxContext},this.props))}}]),t}(E.Component);return e.contextTypes={dxContext:u.object},e}},e.DynamicComponentsList=Q,e.SimpleListView=V,e.getI18n=O,e.TestLayout=F,e.MutationExample=Z,e.NodesTableViewMaterial=ee,e.withNodesFromPath=A,e.withPathFromSelection=function(n){return function(e){return b.connect(function(e,t){return _({},t,{path:e["selectedPaths_"+n]&&1===e["selectedPaths_"+n].length?e["selectedPaths_"+n][0]:null})},function(){return{}})(e)}},e.Picker=ne,e.createOutletHistory=T,e.OutletRouter=L,e.RouterExample=M,e.reducers=h,e.store=x,e.resetStateReducer=function(e,t){if("RESET_STATE"!==t.type)return e},e.theme=C,Object.defineProperty(e,"__esModule",{value:!0})});