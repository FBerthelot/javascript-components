!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("react-dom"),require("material-ui/styles/index"),require("material-ui"),require("lodash"),require("react-apollo"),require("graphql-tag"),require("@jahia/apollo-dx"),require("prop-types"),require("react-redux"),require("material-ui-icons"),require("redux"),require("history"),require("react-router"),require("react-router-dom")):"function"==typeof define&&define.amd?define(["exports","react","react-dom","material-ui/styles/index","material-ui","lodash","react-apollo","graphql-tag","@jahia/apollo-dx","prop-types","react-redux","material-ui-icons","redux","history","react-router","react-router-dom"],t):t((e.jahia=e.jahia||{},e.jahia.reactcomponents={}),e.React,e.ReactDOM,e.materialUiStyles,e.materialUi,e._,e.reactApollo,e.gql,e.jahia.apollodx,e.PropTypes,e.reactRedux,e.materialUiIcons,e.redux,e.history,e.reactRouter,e.reactRouterDom)}(this,function(e,t,n,r,o,a,i,s,l,p,u,c,d,h,m,f){"use strict";var y="default"in t?t.default:t;n=n&&n.hasOwnProperty("default")?n.default:n,s=s&&s.hasOwnProperty("default")?s.default:s,p=p&&p.hasOwnProperty("default")?p.default:p;var v=o.createMuiTheme(),P=o.createMuiTheme({palette:{contrastThreshold:3.1,tonalOffset:.07,primary:{light:indigo[300],main:indigo[500],dark:indigo[700],contrastText:v.palette.getContrastText(indigo[500])},secondary:{light:pink.A200,main:pink.A400,dark:pink.A700,contrastText:v.palette.getContrastText(pink.A400)},error:red.A400}}),E=(function(){function e(e){this.value=e}function t(t){var n,r;function o(n,r){try{var i=t[n](r),s=i.value;s instanceof e?Promise.resolve(s.value).then(function(e){o("next",e)},function(e){o("throw",e)}):a(i.done?"return":"normal",i.value)}catch(e){a("throw",e)}}function a(e,t){switch(e){case"return":n.resolve({value:t,done:!0});break;case"throw":n.reject(t);break;default:n.resolve({value:t,done:!1})}(n=n.next)?o(n.key,n.arg):r=null}this._invoke=function(e,t){return new Promise(function(a,i){var s={key:e,arg:t,resolve:a,reject:i,next:null};r?r=r.next=s:(n=r=s,o(e,t))})},"function"!=typeof t.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)}}(),function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}),g=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},T=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},O=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},k=function(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))},R=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},C=function(e){T(t,e);function t(e){E(this,t);var n=O(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={reactElements:[]},n}return g(t,[{key:"componentDidMount",value:function(){var e=this;this.props.components&&!this.done&&this.props.components.then(function(t){e.done=!0,e.setState({reactElements:t})})}},{key:"componentDidUpdate",value:function(){this.componentDidMount()}},{key:"render",value:function(){return this.done?y.createElement(r.MuiThemeProvider,{muiTheme:P},y.createElement("div",null,this.state.reactElements)):y.createElement("div",null)}}]),t}(y.Component),S=k(['\n                query ComponentsQuery($query:String!) {\n                    jcr {\n                        nodesByQuery(query:$query) {\n                            nodes {\n                                name\n                                path\n                                primaryNodeType {\n                                    name\n                                }\n                                children {\n                                    nodes {\n                                        name\n                                        path\n                                        primaryNodeType {\n                                            name\n                                        }\n                                        renderedView(templateType:"js", view:"react") {\n                                            output\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }'],['\n                query ComponentsQuery($query:String!) {\n                    jcr {\n                        nodesByQuery(query:$query) {\n                            nodes {\n                                name\n                                path\n                                primaryNodeType {\n                                    name\n                                }\n                                children {\n                                    nodes {\n                                        name\n                                        path\n                                        primaryNodeType {\n                                            name\n                                        }\n                                        renderedView(templateType:"js", view:"react") {\n                                            output\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }']),q=function(e){T(t,e);function t(e){E(this,t);var n=O(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.componentCache=[],n}return g(t,[{key:"mapResultsToProps",value:function(e){var t=e.data,r=e.ownProps,o=[],i=t.jcr,s=eval;i&&i.nodesByQuery&&(o=a.map(a.flatMap(i.nodesByQuery.nodes,"children.nodes"),function(e){return s("("+e.renderedView.output+")")}));var l=[];a.each(o,function(e){l=l.concat(e.getImports())});var p=void 0;return l.length>0&&(p=Promise.all(a.map(l,function(e){return SystemJS.import(e)})).then(function(e){return a.map(o,function(t){var r=t.getImports().length,o=t.createElement.apply(t,[y,n].concat(R(e)));return e.splice(r),o})})),b({},r,{components:p})}},{key:"mapPropsToOptions",value:function(e){return{variables:{query:"select * from [reactnt:componentsFolder] where [react:id]='"+e.id+"'"}}}},{key:"render",value:function(){var e=this.props.renderComponent,t=a.find(this.componentCache,function(t){return t.renderComponent===e}),n=void 0;if(t)n=t.dataComponent;else{var r=s(S);n=i.graphql(r,{props:this.mapResultsToProps,options:this.mapPropsToOptions})(e||C),this.componentCache.push({renderComponent:e,dataComponent:n})}return y.createElement(i.ApolloProvider,{client:l.client},y.createElement(n,this.props))}}]),t}(y.Component);q.propTypes={id:p.string.isRequired,renderComponent:p.element};var x=function(e){var t=this;return y.createElement(r.MuiThemeProvider,{muiTheme:P},y.createElement(o.List,{value:e.selectedPath,onChange:function(t,n){n&&e.pickerEntries.find(function(e){return e.path===n}).selectable&&e.onSelectItem(n,!0)}},e.pickerEntries.map(function(n){return y.createElement(o.ListItem,{value:n.path,key:n.path,nestedLevel:n.depth+1,primaryText:e.textRenderer?e.textRenderer.call(t,n):n.name,rightIconButton:n.openable?y.createElement(o.IconButton,{onClick:function(){return e.onOpenItem(n.path,!n.open)}},n.open?y.createElement(c.ExpandLess,null):y.createElement(c.ExpandMore,null)):null})})))};x.propTypes={pickerEntries:p.array.isRequired,selectedPath:p.string,onSelectItem:p.func,onOpenItem:p.func,textRenderer:p.func};var N=function(e){var t=this;return y.createElement(r.MuiThemeProvider,{muiTheme:P},y.createElement(o.List,null,e.pickerEntries.map(function(n){return y.createElement(o.ListItem,{primaryTogglesNestedList:!0,key:n.path,nestedLevel:n.depth+1,primaryText:e.textRenderer?e.textRenderer.call(t,n):n.name,leftCheckbox:n.selectable?y.createElement(o.Checkbox,{checked:n.selected}):null,onClick:function(){n.selectable&&e.onSelectItem(n.path,!n.selected)},rightIconButton:n.openable?y.createElement(o.IconButton,{onClick:function(){return e.onOpenItem(n.path,!n.open)}},n.open?y.createElement(c.ExpandLess,null):y.createElement(c.ExpandMore,null)):null})})))};N.propTypes={pickerEntries:p.array.isRequired,onSelectItem:p.func,onOpenItem:p.func,textRenderer:p.func};var j=k(["\n                query PickerQuery($rootPaths:[String!]!, $selectable:[String]!, $openable:[String]!, $openPaths:[String!]!, $types:[String]!) {\n                    jcr {\n                        rootNodes:nodesByPath(paths: $rootPaths) {\n                            path\n                            uuid\n                            name\n                            selectable : isNodeType(type: {types:$selectable})\n                            openable : isNodeType(type: {types:$openable})\n                            ... node\n                        },\n                        openNodes:nodesByPath(paths: $openPaths) {\n                            path\n                            uuid\n                            children(typesFilter:{types:$types}) {\n                                nodes {\n                                    path\n                                    uuid\n                                    name\n                                    selectable : isNodeType(type: {types:$selectable})\n                                    openable : isNodeType(type: {types:$openable})\n                                    ... node\n                                }\n                            }\n                        }\n                    }\n                }"],["\n                query PickerQuery($rootPaths:[String!]!, $selectable:[String]!, $openable:[String]!, $openPaths:[String!]!, $types:[String]!) {\n                    jcr {\n                        rootNodes:nodesByPath(paths: $rootPaths) {\n                            path\n                            uuid\n                            name\n                            selectable : isNodeType(type: {types:$selectable})\n                            openable : isNodeType(type: {types:$openable})\n                            ... node\n                        },\n                        openNodes:nodesByPath(paths: $openPaths) {\n                            path\n                            uuid\n                            children(typesFilter:{types:$types}) {\n                                nodes {\n                                    path\n                                    uuid\n                                    name\n                                    selectable : isNodeType(type: {types:$selectable})\n                                    openable : isNodeType(type: {types:$openable})\n                                    ... node\n                                }\n                            }\n                        }\n                    }\n                }"]),w=function(e){T(t,e);function t(e){E(this,t);var n=O(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.componentCache=[],n}return g(t,[{key:"mapResultsToProps",value:function(e){var t=e.data,n=e.ownProps,r=n.multipleSelection?n.selectedPaths:[n.selectedPath],o=n.openPaths?n.openPaths:[],i=[],s={},l=t.jcr,p=function(e,t,n){var l=!1;e.selectable&&(l=-1!==a.indexOf(r,e.path));var p={name:e.name,path:e.path,open:e.openable&&-1!==a.indexOf(o,e.path),selected:l,openable:e.openable,selectable:e.selectable,depth:t,prefix:a.repeat("&nbsp;",3*t),node:e,hidden:!1};return i.splice(n,0,p),s[e.uuid]=p,p};l&&(l.rootNodes&&a.forEach(l.rootNodes,function(e){p(e,0,0).hidden=n.hideRoot}),l.openNodes&&a.sortBy(l.openNodes,["path"]).forEach(function(e){var t=s[e.uuid];if(t){var n=a.indexOf(i,t);a.forEachRight(e.children.nodes,function(e){p(e,t.depth+1,n+1)})}}));var u=a.filter(i,function(e){return e.selected}).map(function(e){return e.node});return r=a.map(u,"path"),i=a.filter(i,function(e){return!e.hidden}),b({},n,{pickerEntries:i})}},{key:"mapPropsToOptions",value:function(e){var t=e.openPaths?e.openPaths:[],n=function(e,n){var r=!1;a.tail(a.split(n,"/")).reduce(function(n,o){return r||a.forEach(e.rootPaths,function(e){r=r||a.startsWith(n,e)}),r&&-1===a.indexOf(t,n)&&t.push(n),n+"/"+o},"")};e.multipleSelection?a.each(e.selectedPaths,function(t){return n(e,t)}):n(e,e.selectedPath);var r={rootPaths:e.rootPaths,types:a.union(e.openableTypes,e.selectableTypes),selectable:e.selectableTypes,openable:e.openableTypes,openPaths:t};return e.variables&&a.assign(r,e.variables),{variables:r}}},{key:"render",value:function(){var e=this.props.fragments,t=this.props.renderComponent,n=a.find(this.componentCache,function(n){return JSON.stringify(n.fragments)===JSON.stringify(e)&&n.renderComponent===t}),r=void 0;if(n)r=n.dataComponent;else{var o=s(j);l.replaceFragmentsInDocument(o,e),r=i.graphql(o,{props:this.mapResultsToProps,options:this.mapPropsToOptions})(t||this.props.multipleSelection?N:x),this.componentCache.push({fragments:e,renderComponent:t,dataComponent:r})}return y.createElement(i.ApolloProvider,{client:l.client},y.createElement(r,this.props))}}]),t}(y.Component);w.propTypes={rootPaths:p.arrayOf(p.string).isRequired,openPaths:p.arrayOf(p.string),openableTypes:p.arrayOf(p.string).isRequired,selectableTypes:p.arrayOf(p.string).isRequired,multipleSelection:p.bool,selectedPath:p.string,selectedPaths:p.arrayOf(p.string),textRenderer:p.func,renderComponent:p.element,fragments:p.arrayOf(p.oneOfType([p.string,p.shape({applyFor:p.string.isRequired,variables:p.string,gql:p.object.isRequired})])),variables:p.object};var I={},$=function(){var e=void 0;return"undefined"!=typeof window&&(e=window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__({name:"DX Redux",instanceId:"dx"})),d.createStore(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];return a.mapValues(I,function(n,r){return n(e[r],t)})},e)}(),L=function(e,t){if("RESET_STATE"!==t.type)return e},M=function(e){T(t,e);function t(e){E(this,t);var n=O(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.PickerReduxWithoutStore=u.connect(n.mapStateToProps,n.mapDispatchToProps)(w),n}return g(t,[{key:"mapStateToProps",value:function(e,t){return t.multipleSelection?b({},t,{openPaths:e["openPaths_"+t.id]?e["openPaths_"+t.id]:t.openPaths,selectedPaths:e["selectedPaths_"+t.id]?e["selectedPaths_"+t.id]:t.selectedPaths}):b({},t,{openPaths:e["openPaths_"+t.id]?e["openPaths_"+t.id]:t.openPaths,selectedPath:e["selectedPath_"+t.id]?e["selectedPath_"+t.id]:t.selectedPath})}},{key:"mapDispatchToProps",value:function(e,t){return{onSelectItem:function(n,r){e({type:r?"SELECT_PICKER_ENTRY_"+t.id:"UNSELECT_PICKER_ENTRY_"+t.id,path:n})},onOpenItem:function(n,r){e({type:r?"OPEN_PICKER_ENTRY_"+t.id:"CLOSE_PICKER_ENTRY_"+t.id,path:n})}}}},{key:"openPaths",value:function(){var e=this;return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.props.openPaths||[],n=arguments[1],r=t.indexOf(n.path);return n.type==="OPEN_PICKER_ENTRY_"+e.props.id&&-1===r?[].concat(R(t),[n.path]):n.type==="CLOSE_PICKER_ENTRY_"+e.props.id&&-1!==r?_.filter(t,function(e){return e!==n.path}):t}}},{key:"selectedPath",value:function(){var e=this;return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.props.selectedPath,n=arguments[1];return n.type==="SELECT_PICKER_ENTRY_"+e.props.id?n.path:n.type==="UNSELECT_PICKER_ENTRY_"+e.props.id?null:t}}},{key:"selectedPaths",value:function(){var e=this;return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.props.selectedPaths||[],n=arguments[1],r=t.indexOf(n.path);return n.type==="SELECT_PICKER_ENTRY_"+e.props.id&&-1===r?[].concat(R(t),[n.path]):n.type==="UNSELECT_PICKER_ENTRY_"+e.props.id&&-1!==r?_.filter(t,function(e){return e!==n.path}):t}}},{key:"componentWillMount",value:function(){I["openPaths_"+this.props.id]=this.openPaths(),this.props.multipleSelection?I["selectedPaths_"+this.props.id]=this.selectedPaths():I["selectedPath_"+this.props.id]=this.selectedPath()}},{key:"componentWillUnmount",value:function(){I["openPaths_"+this.props.id]=L,I["selectedPath_"+this.props.id]=L,I["selectedPaths_"+this.props.id]=L,$.dispatch({type:"RESET_STATE"}),delete I["openPaths_"+this.props.id],delete I["selectedPath_"+this.props.id],delete I["selectedPaths_"+this.props.id]}},{key:"render",value:function(){var e=this.PickerReduxWithoutStore;return y.createElement(u.Provider,{store:$},y.createElement(e,this.props))}}]),t}(y.Component);M.propTypes={id:p.string,rootPaths:p.arrayOf(p.string).isRequired,openPaths:p.arrayOf(p.string),openableTypes:p.arrayOf(p.string).isRequired,selectableTypes:p.arrayOf(p.string).isRequired,multipleSelection:p.bool,selectedPath:p.string,selectedPaths:p.arrayOf(p.string),textRenderer:p.func,renderComponent:p.element,fragments:p.arrayOf(p.oneOfType([p.string,p.shape({applyFor:p.string.isRequired,variables:p.string,gql:p.object.isRequired})])),variables:p.object};var D=function(e){T(t,e);function t(e){E(this,t);var n=O(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return e.multipleSelection?n.state={openPaths:e.openPaths?e.openPaths:[],selectedPaths:e.selectedPaths?e.selectedPaths:[]}:n.state={openPaths:e.openPaths?e.openPaths:[],selectedPath:e.selectedPath?e.selectedPath:null},n}return g(t,[{key:"onSelectItem",value:function(e,t,n){this.props.multipleSelection?this.setState({openPaths:e.openPaths,selectedPaths:n?[].concat(R(e.selectedPaths),[t]):a.filter(e.selectedPaths,function(e){return e!==t})}):this.setState({openPaths:e.openPaths,selectedPath:n?t:null})}},{key:"onOpenItem",value:function(e,t,n){this.props.multipleSelection?this.setState({openPaths:n?[].concat(R(e.openPaths),[t]):a.filter(e.openPaths,function(e){return e!==t}),selectedPaths:e.selectedPaths}):this.setState({openPaths:n?[].concat(R(e.openPaths),[t]):a.filter(e.openPaths,function(e){return e!==t}),selectedPath:e.selectedPath})}},{key:"render",value:function(){return this.props.multipleSelection?y.createElement(w,b({},this.props,{openPaths:this.state.openPaths,selectedPaths:this.state.selectedPaths,onOpenItem:this.onOpenItem.bind(this,this.state),onSelectItem:this.onSelectItem.bind(this,this.state)})):y.createElement(w,b({},this.props,{openPaths:this.state.openPaths,selectedPath:this.state.selectedPath,onOpenItem:this.onOpenItem.bind(this,this.state),onSelectItem:this.onSelectItem.bind(this,this.state)}))}}]),t}(y.Component);D.propTypes={rootPaths:p.arrayOf(p.string).isRequired,openPaths:p.arrayOf(p.string),openableTypes:p.arrayOf(p.string).isRequired,selectableTypes:p.arrayOf(p.string).isRequired,multipleSelection:p.bool,selectedPath:p.string,selectedPaths:p.arrayOf(p.string),textRenderer:p.func,renderComponent:p.element,fragments:p.arrayOf(p.oneOfType([p.string,p.shape({applyFor:p.string.isRequired,variables:p.string,gql:p.object.isRequired})])),variables:p.object};var B=function(e){var t="state"===e.pickerType?D:M;return y.createElement(t,e)};B.propTypes={id:p.string,pickerType:p.oneOf(["state","redux"]),rootPaths:p.arrayOf(p.string).isRequired,openPaths:p.arrayOf(p.string),openableTypes:p.arrayOf(p.string).isRequired,selectableTypes:p.arrayOf(p.string).isRequired,multipleSelection:p.bool,selectedPath:p.string,selectedPaths:p.arrayOf(p.string),textRenderer:p.func,renderComponent:p.element,fragments:p.arrayOf(p.oneOfType([p.string,p.shape({applyFor:p.string.isRequired,variables:p.string,gql:p.object.isRequired})])),variables:p.object},B.defaultProps={rootPaths:["/"],openableTypes:["nt:base"],selectableTypes:["nt:base"]};var A=function(e){var t=this;return y.createElement("div",null,e.pickerEntries.map(function(n){return y.createElement("div",{key:n.path,style:{marginLeft:10*n.depth+"px"}},y.createElement("input",{type:"checkbox",checked:n.open,onChange:function(t){return e.onOpenItem(n.path,t.target.checked)}}),y.createElement("input",{type:"checkbox",checked:n.selected,onChange:function(t){return e.onSelectItem(n.path,t.target.checked)}}),y.createElement("span",null,e.textRenderer?e.textRenderer.call(t,n):n.name))}))};A.propTypes={pickerEntries:p.array.isRequired,onSelectItem:p.func,onOpenItem:p.func,textRenderer:p.func};var F=function(e){var t=this,n=e.headers?e.headers:function(){return y.createElement(o.TableRow,null,y.createElement(o.TableCell,null,"Name"))},a=e.row?e.row:function(n){return y.createElement(o.TableRow,{key:n.path},y.createElement(o.TableCell,null,e.textRenderer?e.textRenderer.call(t,n):n.name))};return y.createElement(r.MuiThemeProvider,{muiTheme:P},y.createElement(o.Table,null,y.createElement(o.TableHead,null,n()),y.createElement(o.TableBody,null,e.nodes?e.nodes.map(a):[])))};F.propTypes={headers:p.func,row:p.func,textRenderer:p.func,nodes:p.arrayOf(p.object).isRequired};var Q=k(["\n                query NodesQuery($path:String!, $types:[String]!) {\n                    jcr {\n                        node:nodeByPath(path: $path) {\n                            path\n                            uuid\n                            name\n                            children(typesFilter:{types:$types}) {\n                                nodes {\n                                    path\n                                    uuid\n                                    name\n                                    ... node\n                                }\n                            }\n                        }\n                    }\n                }"],["\n                query NodesQuery($path:String!, $types:[String]!) {\n                    jcr {\n                        node:nodeByPath(path: $path) {\n                            path\n                            uuid\n                            name\n                            children(typesFilter:{types:$types}) {\n                                nodes {\n                                    path\n                                    uuid\n                                    name\n                                    ... node\n                                }\n                            }\n                        }\n                    }\n                }"]),V=function(e){T(t,e);function t(e){E(this,t);var n=O(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.componentCache=[],n}return g(t,[{key:"mapResultsToProps",value:function(e){var t=e.data,n=e.ownProps,r=[],o=t.jcr;return o&&o.node&&(r=o.node.children.nodes),b({},n,{nodes:r})}},{key:"mapPropsToOptions",value:function(e){var t={path:e.path,types:e.types};return e.variables&&a.assign(t,e.variables),{variables:t,skip:!e.path}}},{key:"render",value:function(){var e=this.props.fragments,t=this.props.renderComponent,n=a.find(this.componentCache,function(n){return JSON.stringify(n.fragments)===JSON.stringify(e)&&n.renderComponent===t}),r=void 0;if(n)r=n.dataComponent;else{var o=s(Q);l.replaceFragmentsInDocument(o,e),r=i.graphql(o,{props:this.mapResultsToProps,options:this.mapPropsToOptions})(t||F),this.componentCache.push({fragments:e,renderComponent:t,dataComponent:r})}return y.createElement(i.ApolloProvider,{client:l.client},y.createElement(r,this.props))}}]),t}(y.Component);V.propTypes={path:p.string.isRequired,types:p.arrayOf(p.string).isRequired,headers:p.func,row:p.func,textRenderer:p.func,renderComponent:p.element,fragments:p.arrayOf(p.oneOfType([p.string,p.shape({applyFor:p.string.isRequired,variables:p.string,gql:p.object.isRequired})])),variables:p.object};var U=function(e){T(t,e);function t(e){E(this,t);var n=O(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.NodesTableWithoutStore=u.connect(n.mapStateToProps,n.mapDispatchToProps)(V),n}return g(t,[{key:"mapStateToProps",value:function(e,t){return b({},t,{path:e["selectedPath_"+t.id]?e["selectedPath_"+t.id]:t.defaultPath})}},{key:"mapDispatchToProps",value:function(e,t){return{}}},{key:"componentWillMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=this.NodesTableWithoutStore;return y.createElement(u.Provider,{store:$},y.createElement(e,this.props))}}]),t}(y.Component);U.propTypes={id:p.string,defaultPath:p.string.isRequired,types:p.arrayOf(p.string).isRequired,headers:p.func,row:p.func,textRenderer:p.func,renderComponent:p.element,fragments:p.arrayOf(p.oneOfType([p.string,p.shape({applyFor:p.string.isRequired,variables:p.string,gql:p.object.isRequired})])),variables:p.object};var W=function(e){return y.createElement(o.Grid,{container:!0},y.createElement(o.Grid,{item:!0,xs:12,md:6},y.createElement(Paper,null," ",e.leftCol)),y.createElement(o.Grid,{item:!0,xs:12,md:6},y.createElement(Paper,null,e.rightCol)))};W.propTypes={leftCol:p.element,rightCol:p.element};function H(e,t){var n=this,r=function(n){var r=[],o=e.location.pathname,i=t+":"+n;return o.indexOf("(")>-1&&(r=(o=(o=o.substr(o.indexOf("(")+1)).substr(0,o.indexOf(")"))).split("//"),r=a.map(r,function(e){return e.startsWith(t+":")?i:e})),-1===r.indexOf(i)&&r.push(i),"/("+a.join(r,"//")+")"},o=function(n){var r=void 0;return n?(r=e.location.state?e.location.state:{})["router_"+t]=n:e.location.state&&delete(r=e.location.state)["router_"+t],r},i=function(e){if(e.indexOf("(")>-1){var n=(e=(e=e.substr(e.indexOf("(")+1)).substr(0,e.indexOf(")"))).split("//"),r=t+":",o=a.find(n,function(e){return e.startsWith(r)});if(o)return o.substr(r.length)}return""},s=a.clone(e.location);s.pathname=i(s.pathname);var l=[],p={length:e.length,action:e.action,location:s,createHref:function(t){return e.createHref({pathname:r(t.pathname)})},push:function(t,n){return e.push(r(t),o(n))},replace:function(t,n){e.replace(r(t),o(n))},go:function(t){e.go(t)},goBack:function(){e.goBack()},goForward:function(){e.goForward()},block:function(t){return e.block(t)},listen:function(e){return l.push(e),function(){a.pull(l,e)}},dispose:function(){u()}},u=e.listen(function(e){var r=i(e.pathname),o=void 0;e.state&&e.state["router_"+t]&&(o=e.state["router_"+t]),p.location.pathname===r&&p.location.state===o||(Object.assign(p.location,e),p.location.pathname=r,p.location.state=o,a.each(l,function(e){return e.call(n,p.location)}))});return p}var K=h.createHashHistory(),Y=function(e){T(t,e);function t(e){E(this,t);var n=O(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.outletHistory=H(K,e.outlet),n}return g(t,[{key:"componentWillMount",value:function(){}},{key:"componentWillUnmount",value:function(){this.outletHistory.dispose()}},{key:"render",value:function(){return y.createElement(m.Router,{history:this.outletHistory},this.props.children)}}]),t}(y.Component),J=function(e){T(t,e);function t(e){E(this,t);var n=O(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={open:!1},n.components=[{link:"/link1",label:"Link 1",component:function(e){return y.createElement("div",null,"toto")}},{link:"/link2",label:"Link 2",component:function(e){return y.createElement("div",null,"titi")}}],n}return g(t,[{key:"handleOpen",value:function(){this.setState({open:!0})}},{key:"handleClose",value:function(){this.setState({open:!1})}},{key:"render",value:function(){var e=this;return y.createElement(r.MuiThemeProvider,{muiTheme:P},y.createElement("div",null,y.createElement(o.Button,{label:"Open",onClick:function(){return e.handleOpen()}}),y.createElement(o.Dialog,{title:"Dialog With Actions",actions:[y.createElement(o.Button,{label:"Cancel",primary:!0,onClick:function(){return e.handleClose()}}),y.createElement(o.Button,{label:"Submit",primary:!0,keyboardFocused:!0,onClick:function(){return e.handleClose()}})],modal:!1,open:this.state.open,onRequestClose:function(){return e.handleClose()}},y.createElement(Y,{outlet:"outlet1"},y.createElement("div",null,y.createElement("div",null,a.map(this.components,function(e){return y.createElement(f.Link,{key:e.link,to:e.link},e.label)})),y.createElement("div",null,a.map(this.components,function(e){return y.createElement(f.Route,{key:e.link,path:e.link,component:e.component})})))),y.createElement(Y,{outlet:"outlet2"},y.createElement("div",null,y.createElement("div",null,a.map(this.components,function(e){return y.createElement(f.Link,{key:e.link,to:e.link},e.label)})),y.createElement("div",null,a.map(this.components,function(e){return y.createElement(f.Route,{key:e.link,path:e.link,component:e.component})})))))))}}]),t}(y.Component),X=function(e){T(t,e);function t(e){return E(this,t),O(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return g(t,[{key:"render",value:function(){var e=function(e){return y.createElement("div",null,"Test1 ",e.match.params.value)},t=function(e){return y.createElement("div",null,"Test2")};return y.createElement(Y,{outlet:this.props.id},y.createElement("div",null,"---- links : ----",y.createElement(f.Link,{to:"/test1/toto"},"Test1 toto")," -",y.createElement(f.Link,{to:"/test1/tutu"},"Test1 tutu")," -",y.createElement(f.Link,{to:"/test2"},"Test2")," -",y.createElement(f.Link,{to:"/test3"},"Test3")," -",y.createElement(Y,{outlet:"new"},y.createElement("div",null,y.createElement(f.Link,{to:"/test1"},"Test1/other")," -",y.createElement(f.Link,{to:"/test2"},"Test2/other"))),"---- routes : ----",y.createElement(f.Route,{path:"/test1/:value",component:e}),y.createElement(f.Route,{path:"/test2",component:t}),y.createElement(f.Route,{path:"/test3",component:function(e){return y.createElement("div",null,"Test3")}}),y.createElement(Y,{outlet:"new"},y.createElement("div",null,y.createElement(f.Route,{path:"/test1",component:e}),y.createElement(f.Route,{path:"/test2",component:t}))),"------------------"))}}]),t}(y.Component),G=k(['fragment Test on JCRNode {\n            myprop:property(name:"myprop") {\n                value\n            }\n        }'],['fragment Test on JCRNode {\n            myprop:property(name:"myprop") {\n                value\n            }\n        }']),z=k(['\n    mutation setProperty($value:String,$path:String!) {\n        jcr {\n            mutateNode(pathOrId:$path) {\n                mutateProperty(name:"myprop") {\n                    setValue(value:$value)\n                }\n                node {\n                    path\n                }\n            }\n        }\n    }\n'],['\n    mutation setProperty($value:String,$path:String!) {\n        jcr {\n            mutateNode(pathOrId:$path) {\n                mutateProperty(name:"myprop") {\n                    setValue(value:$value)\n                }\n                node {\n                    path\n                }\n            }\n        }\n    }\n']),Z=k(['\n    mutation addNode($value:String, $name:String!) {\n        jcr {\n            addNode(parentPathOrId:"/",name:$name,primaryNodeType:"nt:unstructured") {\n                mutation {\n                    mutateProperty(name:"myprop") {\n                        setValue(value:$value)\n                    }\n                }\n            }\n        }\n    }\n'],['\n    mutation addNode($value:String, $name:String!) {\n        jcr {\n            addNode(parentPathOrId:"/",name:$name,primaryNodeType:"nt:unstructured") {\n                mutation {\n                    mutateProperty(name:"myprop") {\n                        setValue(value:$value)\n                    }\n                }\n            }\n        }\n    }\n']),ee=k(["\n    mutation removeNode($path:String!) {\n        jcr {\n            deleteNode(pathOrId:$path) \n        }\n    }\n"],["\n    mutation removeNode($path:String!) {\n        jcr {\n            deleteNode(pathOrId:$path) \n        }\n    }\n"]),te=function(e){T(t,e);function t(e){return E(this,t),O(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return g(t,[{key:"render",value:function(){var e=this,t=[{applyFor:"node",gql:s(G)}];return y.createElement(r.MuiThemeProvider,{muiTheme:P},y.createElement("div",null,y.createElement(o.Button,{label:"New",onClick:function(){return e.props.addNodeMutation({variables:{name:"name-"+(new Date).getTime(),value:"test:"+new Date},refetchQueries:["NodesQuery"]})}}),y.createElement(V,{path:"/",types:["nt:unstructured"],fragments:t,renderComponent:function(t){return y.createElement(o.Table,null,y.createElement(o.TableHead,null,y.createElement(o.TableRow,null,y.createElement(o.TableCell,null,"Name"),y.createElement(o.TableCell,null,"Value"),y.createElement(o.TableCell,null,"Update"),y.createElement(o.TableCell,null,"Delete"))),y.createElement(o.TableBody,null,t.nodes?t.nodes.map(function(t){return y.createElement(o.TableRow,{key:t.uuid},y.createElement(o.TableCell,null,t.name),y.createElement(o.TableCell,null,t.myprop.value),y.createElement(o.TableCell,null,y.createElement(o.Button,{label:"Update",onClick:function(){return e.props.setPropertyMutation({variables:{path:t.path,value:"test:"+new Date},refetchQueries:["NodesQuery"]})}})),y.createElement(o.TableCell,null,y.createElement(o.Button,{label:"Delete",onClick:function(){return e.props.removeNodeMutation({variables:{path:t.path},refetchQueries:["NodesQuery"]})}})))}):[]))}})))}}]),t}(t.Component),ne=s(z),re=s(Z),oe=s(ee),ae=function(e){T(t,e);function t(e){E(this,t);var n=O(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.Component=i.graphql(ne,{name:"setPropertyMutation"})(i.graphql(re,{name:"addNodeMutation"})(i.graphql(oe,{name:"removeNodeMutation"})(te))),n}return g(t,[{key:"render",value:function(){var e=this.Component;return y.createElement(i.ApolloProvider,{client:l.client},y.createElement(e,null))}}]),t}(y.Component);e.DynamicComponentsList=q,e.SimpleListView=C,e.Picker=B,e.PickerData=w,e.PickerView=A,e.PickerViewMaterial=x,e.PickerViewMaterialMultiple=N,e.NodesTable=U,e.NodesTableData=V,e.NodesTableViewMaterial=F,e.TestLayout=W,e.Engine=J,e.createOutletHistory=H,e.OutletRouter=Y,e.RouterExample=X,e.MutationExample=ae,e.reducers=I,e.store=$,e.resetStateReducer=L,e.theme=P,Object.defineProperty(e,"__esModule",{value:!0})});